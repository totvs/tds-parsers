#INCLUDE "PROTHEUS.CH"
#INCLUDE "CFGX046.CH"
#DEFINE Confirma 1
#DEFINE Abandona 2

/*/
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o	 Ё CFGX046	Ё Autor Ё Mario Angelo          Ё Data Ё 20.03.96 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Gerador de arquivo texto para receita federal - IN68       Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso		 Ё GENERICO                                                   Ё╠╠
╠╠цддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё ATUALIZACOES SOFRIDAS DESDE A CONSTRUCAO INICIAL.                     Ё╠╠
╠╠цддддддддддддддбддддддддбддддддбдддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё PROGRAMADOR  Ё DATA   Ё BOPS Ё  MOTIVO DA ALTERACAO                   Ё╠╠
╠╠цддддддддддддддеддддддддеддддддедддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё              Ё        Ё      Ё                                        Ё╠╠
╠╠юддддддддддддддаддддддддаддддддадддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
/*/

Function Cfgx046()

	Local oDlg
	Local nOpcA:=2
	Local cTela1,cSaveMenuh
	Local nLidos:=0,nTamArq:=0
	Local aConteudo:={},xBuffer
	Local nHdlArq
	Local cAlias,cArquivoINI
	Local cMensagem
	Local lLer := .T.,i
	Local lAbriu:= .F.,cFile
	Local cArquivos:="",cAliasAnt := Alias()
	Local cDiretorio

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Lista de Arquivos verificados                                Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Local aDbfs := {	"SA1","SA2","SA4","SB1","SB2","SB5","SB7","SD1","SD2","SD3","SYD","SE1","SE2","SE5","SF1","SF2",;
		"SG1","SGA","SF4","SM2","SI1","SI2","SI7","SI3","SI8","SN1","SN3","SN4","SRA","SRD","SRJ","SRV",;
		"SX5","SB9","SF5","CT2","CT1","CT7"}

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Criado para tabelas                                          Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Private nHdlSx5
	Private aTabela7 := {}
	Private aTabela0 := {}
	Private cExecPre := ""
	Private cExecPos := ""
	Private nTotReg  := 0
	Private cEspecie
	Private lFirst:=.F.		// Def. se ja processou primeiro item da partida dobrada

	AjustaSx1()

	Aadd(aTabela7,{"01","Cliente"})
	Aadd(aTabela7,{"02","Fornecedor"})
	Aadd(aTabela0,{"01","Material inventariado no estabelecimento"})
	Aadd(aTabela0,{"02","Material em poder de terceiros"})

	DEFINE MSDIALOG oDlg TITLE OemtoAnsi(STR0015) FROM  165,145 TO 325,495 PIXEL OF oMainWnd // "Instru┤└o Normativa SRF 68"
	@ 03, 10 TO 53, 165 LABEL "" OF oDlg  PIXEL
	@ 10, 15 SAY OemToAnsi(STR0016) SIZE 150, 8 OF oDlg PIXEL // "Esta rotina ir═ gerar arquivo texto em meio Magn┌tico conforme"
	@ 20, 15 SAY OemToAnsi(STR0017) SIZE 150, 8 OF oDlg PIXEL // "par┐metros."

	//	@ 30, 15 SAY OemToAnsi(STR0018) SIZE 150, 8 OF oDlg PIXEL // "Este processamento dever═ ser executado em modo"
	//	@ 40, 15 SAY OemToAnsi(STR0019) SIZE 150, 8 OF oDlg PIXEL // "mono-usu═rio."


	DEFINE SBUTTON FROM 60, 110 TYPE 1 ACTION (nOpca:=1,oDlg:End()) ENABLE OF oDlg
	DEFINE SBUTTON FROM 60, 139 TYPE 2 ACTION (nOpca:=2,oDlg:End()) ENABLE OF oDlg
	ACTIVATE MSDIALOG oDlg ON INIT Pergunte("CFG046",.T.)

	If nOpca==Abandona
		DbSelectArea(cAliasAnt)
		Return(Nil)
	EndIf

	For I:=1 To Len(aDbfs)
		If !(AbreArq(aDbfs[i]))
			Loop
		Else
			cArquivos += aDbfs[i]+"Ш"
			lAbriu := .T.
		EndIf
	Next I

	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Perguntas - CFG046										Ё
	//Ё                  										Ё
	//Ё	mv_par01	- Data Inicial								Ё
	//Ё	mv_par02	- Data Final								Ё
	//Ё	mv_par03	- Arquivo Config(INI)						Ё
	//Ё	mv_par04	- Diretorio destino							Ё
	//Ё	mv_par05	- Meio Armazenamento						Ё
	//Ё	mv_par06	- Codificacao								Ё
	//Ё	mv_par07	- Tamanho do Bloco							Ё
	//Ё	mv_par08	- Equip. Utilizado							Ё
	//Ё	mv_par09	- Sist. Operacional							Ё
	//Ё	mv_par10	- Fab./Modelo								Ё
	//Ё	mv_par11	- S.G.Banco Dados							Ё
	//Ё	mv_par12 - Responsavel      							Ё
	//Ё	mv_par13	- CPF              							Ё
	//Ё	mv_par14	- Fone / Fax       							Ё
	//Ё	mv_par15	- Data Inicial para Ativo Fixo	   			Ё
	//Ё	mv_par16	- Data Final para Ativo Fixo				Ё
	//Ё	mv_par17	- Saldo Ctb Mes a Mes?        				Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Private dDataIni := mv_par01, dDataFim	:= mv_par02, cArqConf	:= mv_par03, cDiret  	:= mv_par04
	Private nMes17Ini, nMes17Fim
	Private aLayOut  := {}

	If ! CtbInUse()
		If ! DataMoeda(1, @nMes17Ini, dDataIni)
			Help(" ",1,"MESINVALID")
		End
		If ! DataMoeda(1, @nMes17Fim, dDataFim)
			Help(" ",1,"MESINVALID")
		End
		nMes17Ini := Val(nMes17Ini)
		nMes17Fim := Val(nMes17Fim)
	Endif

	If !lAbriu
		DbSelectArea(cAliasAnt)
		Return(Nil)
	EndIf

	cArquivoIni:=Trim(cArqConf)

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Monta Tabela de Codigos de Unid. de Medida                   Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	aUm		:= VerCod("62")
	aNatEst	:= VerCod("02")

	If SubStr(cDiret,Len(Trim(cDiret)),1) == "\"
		cDiretorio := SubStr(cDiret,1,Len(Trim(cDiret))-1)
	Else
		cDiretorio := SubStr(cDiret,1,Len(Trim(cDiret)))
		cDiret := Trim(cDiret)+"\"
	EndIf

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Cria o Diret╒rio 								             Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	MakeDir(Trim(cDiretorio))

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Abre Norma013.INI                                            Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	nHdlArq := fOpen(cArquivoIni,64)

	If nHdlArq <= 0
		Final(cArquivoINI+oemtoansi(STR0022)) // " N▌O EXISTE"
	EndIf

	nTamArq := fSeek( nHdlArq, 0, 2 )
	fSeek( nHdlArq,0,0 )

	While nLidos <= nTamArq
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Limpa execblock's                                            Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		cExecPre := ""
		cExecPos := ""

		While nLidos <= nTamArq
			If lLer
				xBuffer:=Space(82)
				fRead(nHdlArq,@xBuffer,82)
			End
			lLer := .T.
			If SubStr(xBuffer,1,1) == "[" .or. SubStr(xBuffer,1,1)==Chr(26)
				If Len(aConteudo)=0
					cAlias		:= SubStr(xBuffer,2,3)
					cMensagem	:= SubStr(xBuffer,5,30)
					cFile		:= SubStr(xBuffer,50,3)
					cTabela		:= SubStr(xBuffer,54,2)
					cNroTab		:= SubStr(xBuffer,58,2)
					nLidos		+= 82
					Aadd(aLayOut,SubStr(xBuffer,1,80))
					Loop
				Else
					Exit
				EndIf
			EndIf

			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Verifica se ha pre-processamento configurado                 Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			If SubStr( xBuffer,1,5) = '(PRE)'
				cExecPre := AllTrim(SubStr(xBuffer,7,76))
				nLidos += 82
				Loop
			EndIf
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Verifica se h═ p╒s-processamento                             Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			If SubStr( xBuffer,1,5) = '(POS)'
				cExecPos := AllTrim(SubStr(xBuffer,7,76))
				nLidos += 82
				Loop
			EndIf

			Aadd(aConteudo, SubStr(xBuffer, 1 , 80))
			Aadd(aLayOut  , SubStr(xBuffer, 1 , 80))
			nLidos+=82
		EndDo

		If Len(aConteudo) != 0
			lLer := .F.
			If cAlias $ cArquivos .Or. cAlias = 'TRB'
				Processa({||GeraArq( aConteudo, cAlias, cMensagem, cFile, cTabela)},cMensagem)
			EndIf
		EndIf

		aConteudo := {}
		Loop
	EndDo

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё  Imprime relatorios de acompanhamento					     Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	DbSelectArea("SX5")
	C046Lista()

	FClose(nHdlArq)
	DbSelectArea(cAliasAnt)
	Return(Nil)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o	 Ё GeraArq	Ё Autor Ё Mario Angelo		    Ё Data Ё 20.03.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Gerador de arquivo texto para receita federal Conf NR 13   Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠ЁSintaxe	 Ё GeraArq										              Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso		 Ё GENERICO 									              Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Static Function GeraArq(aConteudo, cAlias, cMensagem, cFile, cTabela)

	Local i
	Local nHdlArq
	Local nFile
	Local cIndSB6
	Local lFiltraSe1	:= Existblock("FILTSE1")
	Local lFiltraSe2	:= Existblock("FILTSE2")
	Local lFiltraSe5	:= Existblock("FILTSE5")
	Local lFiltSf1		:= ExistBlock("FILTSF1")
	Local lFiltSd1		:= ExistBlock("FILTSD1")
	Local cChvLaco		:= ""
	Local aStruSE5		:= SE5->(DbStruct())
	Local nLaco			:= 0
	Local cCondicao	:= ""
	Local cArqTemp
	Local cChaveInd
	Local nIndice
	Local cChaveInformix
	Local cLocProc		:= If(cFile = "SB2", GetMv("MV_LOCPROC"), )
	Local _nMes17Ini, _nMes17Fim, _mv_par01, _mv_par02, nMesFim, nMes
	Local n

	Private cNomeArq

	If Empty(Alltrim(cNroTab))
		cNomeArq := Trim(cDiret)+SubStr(cFile,2,2)+cFilAnt+StrZero(Day(dDataBase),2) + StrZero(Month(dDataBase),2) + ".TXT"
	Else
		cNomeArq := Trim(cDiret)+Alltrim(cNroTab)+cFilAnt+StrZero(Day(dDataBase),2) + StrZero(Month(dDataBase),2) + ".TXT"
	Endif
	IF cAlias # "TRB"
		nHdlArq := MSFCREATE( cNomeArq)
	EndIf

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Executa o Execblock de Pr┌-processamento caso exista         Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If Len(cExecPre) > 2
		cExecPre:=Alltrim(Substr(cExecPre,1,10))
		If Existblock(cExecPre)
			ExecBlock(cExecPre,.F.,.F., { "PRE", cFile } )
		Endif
	Endif

	nFile := Select(cAlias)	// Verifica se abriu o arquivo
	If nFile != 0
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Geracao das tabelas                                          Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If cAlias == "SX5"
			If cFile = 'SX5'
				DbSelectArea("SX5")
				DbSeek(xFilial()+cTabela)

				ProcRegua(LastRec())

				While ! Eof() .And. cTabela = SX5->X5_TABELA .And. SX5->X5_FILIAL = xFilial()
					GravaRegistro(aConteudo,nHdlArq)
					DbSelectArea("SX5")
					DbSkip()

					IncProc()
				EndDo
			ElseIf cFile = "SI1"
				DbSelectArea(cFile)
				DbSeek(xFilial())

				ProcRegua(LastRec())

				cCamFil := Subs(cFile,2,2)+"_FILIAL"

				While ! Eof() .And. &cCamFil == xFilial()
					GravaRegistro(aConteudo,nHdlArq)
					DbSelectArea(cFile)
					DbSkip()

					IncProc()
				EndDo
			ElseIf cFile == "CT1"		//Saldos CTB
				dbSelectArea( "CT1")
				dbSeek( xFilial() )

				ProcRegua(LastRec())

				While !Eof() .and. CT1_FILIAL == xFilial()
					GravaRegistro(aConteudo,nHdlArq)
					DbSelectArea("CT1")
					dbSkip()
					IncProc()
				EndDo
			ElseIf cFile = "SI3"
				DbSelectArea(cFile)
				DbSeek(xFilial())

				ProcRegua(LastRec())

				cCamFil := Subs(cFile,2,2)+"_FILIAL"

				While ! Eof() .And. &cCamFil == xFilial()
					If Empty(SI3->I3_CONTA)
						GravaRegistro(aConteudo,nHdlArq)
					EndIf
					DbSelectArea(cFile)
					DbSkip()

					IncProc()
				EndDo
			ElseIf Substr(cFile,1,2) = "AR"   // Grava os Arrays de Tabelas.
				cArray := "aTabela"+Substr(cFile,3,1)
				For n := 1 to Len(&cArray)
					GravaArray(aConteudo,nHdlArq,n)
				Next
			Else
				If Select(cFile)>0
					DbSelectArea(cFile)
					DbSeek(xFilial())

					nElem := 0
					aNBM := {}

					ProcRegua(LastRec())

					cCamFil := Subs(cFile,2,2)+"_FILIAL"
					While ! Eof() .And. &cCamFil == xFilial()
						If cTabela=="18".And.cFile=="SB1"
							If Empty(B1_POSIPI)
								DbSkip()
								Loop
							Endif
							nElem:=Ascan(aNBM,B1_POSIPI)
							If nElem==0
								AADD(aNBM,B1_POSIPI)
							Else
								DbSkip()
								Loop
							Endif
						Endif
						GravaRegistro(aConteudo,nHdlArq)

						DbSelectArea(cFile)
						DbSkip()

						IncProc()
					EndDo
					If Select("TRB02") > 0
						DbSelectArea("TRB02")
						DbgoTop()

						aCon002 := { 	'DATA       D 08 0-DataInt(dDataBase)',;
							'COD_TABEL  C 03 0-"002"',;
							'COD_UTIL   C 28 0-TRB02->COD',;
							'DESCRICAO  C 45 0-TRB02->DESC' }
						While ! Eof()

							GravaRegistro(aCon002,nHdlArq)

							DbSelectArea("TRB02")
							DbSkip()

							IncProc()
						EndDo
					Endif

					If cFile = "SF4" .And. cTabela = "TM"
						cCamFil := "F5_FILIAL"
						DbSelectArea("SF5")
						DbSeek(xFilial())

						aCon002 := { 	'DATA       D 08 0-DataInt(dDataBase)',;
							'COD_TABEL  C 03 0-"002"',;
							'COD_UTIL   C 28 0-"9" + SF5->F5_CODIGO',;
							'DESCRICAO  C 45 0-SF5->F5_TEXTO' }
						While ! Eof() .And. &cCamFil == xFilial()

							GravaRegistro(aCon002,nHdlArq)

							DbSelectArea("SF5")
							DbSkip()

							IncProc()
						EndDo
					Endif

				Endif
			EndIf
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Lan┤amentos cont═beis                                        Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "SI2"
			DbSelectArea("SI2")
			DbSetOrder(3)
			DbSeek(xFilial()+dtos(dDataIni),.T.)

			ProcRegua(LastRec())

			While !Eof().and.I2_FILIAL==xFilial().And.SI2->I2_DATA <= dDataFim
				If SI2->I2_DC == "-"
					DbSkip()
					Loop
				End
				If SI2->I2_DATA < dDataIni .or. SI2->I2_DATA > dDataFim
					DbSkip()
					Loop
				End
				If SI2->I2_DC $ "DX"
					lFirst:=.T.
					GravaRegistro(aConteudo,nHdlArq)
				End
				If SI2->I2_DC $ "CX"
					lFirst:=.F.
					GravaRegistro(aConteudo,nHdlArq)
				End
				DbSelectArea("SI2")
				DbSkip()

				IncProc()
			EndDo

		ElseIf cFile == "CT2"		// Lancamentos CTB
			dbSelectArea("CT2")
			dbSetOrder(1)
			dbSeek(xFilial()+dtos(dDataIni),.T.)

			ProcRegua(LastRec())

			While !Eof().and. CT2->CT2_FILIAL==xFilial().And.CT2->CT2_DATA <= dDataFim

				If CT2->CT2_DC == "4"
					dbSkip()
					Loop
				End
				If CT2->CT2_DATA < dDataIni .or. CT2->CT2_DATA > dDataFim
					dbSkip()
					Loop
				End
				If CT2->CT2_DC $ "13"		// Debito ou Partida Dobrada
					lFirst:=.T.
					GravaRegistro(aConteudo,nHdlArq)
				Endif
				If CT2->CT2_DC $ "23"	// Credito ou Partida Dobrada
					lFirst:=.F.
					GravaRegistro(aConteudo,nHdlArq)
				Endif
				dbSelectArea("CT2")
				dbSkip()

				IncProc()
			EndDo

			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Saldos cont═beis                                             Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf 	cFile == "SI1" .And. ! CtbInUse() .And.;
				nMes17Ini > 0 .And. nMes17Fim > 0

			DbSelectArea( "SI1")
			DbSeek( xFilial() )

			ProcRegua(LastRec())

			While !Eof() .and. I1_FILIAL == xFilial()
				If SI1->I1_CLASSE != "A"
					DbSkip()
					Loop
				End
				If mv_par17 = 1
					_nMes17Ini := nMes17Ini
					_nMes17Fim := nMes17Fim
					_mv_par01  := mv_par01

					nMesFim    := nMes17Fim

					For nMes 	  := nMes17Ini To nMesFim
						mv_par01  := PerioData(nMes, 1)[1]
						nMes17Ini := nMes
						nMes17Fim := nMes
						If (fSalAnt() # 0 .or. TotDebitos(nMes17Ini,nMes17Fim) # 0 .Or.;
								TotCreditos(nMes17Ini,nMes17Fim) # 0 .Or. CalcSaldo(nMes17Fim) # 0)
							GravaRegistro(aConteudo,nHdlArq)
						Endif
					Next

					nMes17Ini := _nMes17Ini
					nMes17Fim := _nMes17Fim
					mv_par01  := _mv_par01
				Else
					If (fSalAnt() # 0 .or. TotDebitos(nMes17Ini,nMes17Fim) # 0 .Or.;
							TotCreditos(nMes17Ini,nMes17Fim) # 0 .Or. CalcSaldo(nMes17Fim) # 0)
						GravaRegistro(aConteudo,nHdlArq)
					Endif
				Endif
				DbSelectArea("SI1")
				DbSkip()

				IncProc()
			EndDo
		ElseIf cFile == "CT1"		//Saldos CTB
			dbSelectArea( "CT1")
			dbSeek( xFilial() )

			ProcRegua(LastRec())

			While !Eof() .and. CT1_FILIAL == xFilial()
				If CT1->CT1_CLASSE != "2"
					DbSkip()
					Loop
				End
				If mv_par17 = 1
					nMesFim 	:= (Year(mv_par02) - Year(mv_par01)) * 12
					nMesFim 	+= (Month(mv_par02) - Month(mv_par01)) + 1
					_mv_par01  	:= mv_par01
					_mv_par02  	:= mv_par02
					dInicio		:= FirstDay(mv_par01)

					For nMes := 1 To nMesFim
						If nMes > 1
							dInicio  := FirstDay(dInicio + 31)
						Endif
						mv_par01 := dInicio
						mv_par02 := LastDay(dInicio)
						GravaRegistro(aConteudo,nHdlArq)
					Next
					mv_par01 := _mv_par01
					mv_par02 := _mv_par02
				Else
					GravaRegistro(aConteudo,nHdlArq)
				Endif
				DbSelectArea("CT1")
				dbSkip()
				IncProc()
			EndDo

			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Contas a receber                                             Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "SE1"
			DbSelectArea( "SE1")
			DbSetOrder(6)
			DbSeek(xFilial()+Dtos(dDataIni),.T.)

			ProcRegua(LastRec())

			While !Eof().and.E1_FILIAL==xFilial().And.SE1->E1_EMISSAO<=dDataFim
				If SE1->E1_TIPO $ MVRECANT .OR. SE1->E1_TIPO $ MV_CRNEG .OR. SE1->E1_TIPO $ MVABATIM
					DbSkip()
					Loop
				EndIf
				If SE1->E1_EMISSAO < dDataIni .or. SE1->E1_EMISSAO > dDataFim
					DbSkip()
					Loop
				EndIf

				If lFiltraSe1
					If !(Execblock("FILTSE1",.F.,.F.))
						DbSkip()
						Loop
					EndIf
				EndIf

				DbSelectArea( "SA1")
				DbSeek(xFilial()+SE1->E1_CLIENTE+SE1->E1_LOJA)
				DbSelectArea("SE1")
				GravaRegistro(aConteudo,nHdlArq)
				DbSelectArea("SE1")
				DbSkip()

				IncProc()
			EndDo
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Contas a pagar                                               Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "SE2"
			DbSelectArea( "SE2")
			DbSetOrder(7)
			DbSeek(xFilial()+dTos(dDataIni),.T.)

			ProcRegua(LastRec())
			While !Eof().and.E2_FILIAL==xFilial().And.SE2->E2_EMIS1 <= dDataFim
				If SE2->E2_TIPO $ MVPAGANT .OR. SE2->E2_TIPO $ MV_CPNEG .OR. SE2->E2_TIPO $ MVABATIM
					DbSkip()
					Loop
				EndIf
				If SE2->E2_EMIS1 < dDataIni .Or. SE2->E2_EMIS1 > dDataFim
					DbSkip()
					Loop
				EndIf

				If lFiltraSe2
					If !(Execblock("FILTSE2",.F.,.F.))
						DbSkip()
						Loop
					EndIf
				EndIf

				DbSelectArea( "SA2")
				DbSeek(xFilial()+SE2->E2_FORNECE+SE2->E2_LOJA)
				DbSelectArea("SE2")
				GravaRegistro(aConteudo,nHdlArq)
				DbSelectArea("SE2")
				DbSetOrder(7)
				DbSkip()

				IncProc()
			EndDo
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Movimentacao das Baixas a Receber                            Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "BBR"
			#IFDEF TOP
				If TcSrvType() != "AS/400"
					cQuery	:= "SELECT * FROM " + RetSqlName("SE5") + " WHERE "
					cQuery	+= " E5_FILIAL = '" + xFilial("SE5") + "'"
					cQuery	+= " AND E5_DTDIGIT >= '" + DTOS(mv_par01) + "'"
					cQuery	+= " AND E5_DTDIGIT <= '" + DTOS(mv_par02) + "'"
					cQuery	+= " AND D_E_L_E_T_ <> '*'"

					//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
					//Ё Montagem da ordem para Informix                                 Ё
					//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
					If UPPER(TcGetDB()) == "INFORMIX"
						cChaveInformix := ""
						For nLaco:=1 To FCount()
							If AllTrim(FieldName(nLaco)) $ ".E5_FILIAL.E5_DTDIGIT.E5_PREFIXO.E5_NUMERO.E5_PARCELA.E5_TIPO.E5_CLIFOR.E5_LOJA.E5_SEQ."
								cChaveInformix += (StrZero(nLaco,2)+",")
							EndIf
						Next
						//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
						//Ё Descarta a ultima virgula da ordem gerada                       Ё
						//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
						cChaveInformix := SubStr(cChave,1,Len(cChave)-1)
					Else
						cChaveInformix := "E5_FILIAL, E5_DTDIGIT, E5_PREFIXO, E5_NUMERO, E5_PARCELA, E5_TIPO, E5_CLIFOR, E5_LOJA, E5_SEQ"
					EndIf

					cQuery += " ORDER BY " + cChaveInformix

					cQuery := ChangeQuery(cQuery)
					DbUseArea(.T., "TOPCONN", TCGenQry(,,cQuery), 'SE5_TRB', .F., .T.)
					For nLaco:=1 to Len(aStruSE5)
						If aStruSE5[nLaco,2] != 'C'
							TCSetField('SE5_TRB', aStruSE5[nLaco,1], aStruSE5[nLaco,2],aStruSE5[nLaco,3],aStruSE5[nLaco,4])
						EndIf
					Next
				Else
					//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
					//Ё Abre o SE5 com outro alias para ser filtrado porque a funcao    Ё
					//Ё TemBxCanc() utilizara o SE5 sem filtro.						    Ё
					//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
					ChkFile("SE5",.F.,"SE5_TRB")

					DbSelectArea("SE5_TRB")

					cCondicao	:= "SE5_TRB->E5_FILIAL=='"+xFilial("SE5")+"' .And. DTOS(SE5_TRB->E5_DTDIGIT) >='"+DTOS(mv_par01)+"' .And. DTOS(SE5_TRB->E5_DTDIGIT) <= '"+DTOS(mv_par02)+"'"
					cChaveInd	:= "SE5_TRB->E5_FILIAL+DTOS(SE5_TRB->E5_DTDIGIT)+SE5_TRB->E5_PREFIXO+SE5_TRB->E5_NUMERO+SE5_TRB->E5_PARCELA+SE5_TRB->E5_TIPO+SE5_TRB->E5_CLIFOR+SE5_TRB->E5_LOJA+SE5_TRB->E5_SEQ"
					cArqTemp	:= CriaTrab(NIL,.F.)

					IndRegua("SE5_TRB",cArqTemp,cChaveInd,,cCondicao,OemToAnsi(STR0021)+cMensagem)  //"Gerando Movimentacao Bancaria..."
					nIndice := RetIndex("SE5","SE5_TRB")

					DbSelectArea("SE5_TRB")
					DbSetIndex(cArqTemp+OrdBagExt())
					DbSetOrder(nIndice+1)
					DbGotop()
				EndIf
			#ELSE
				//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Abre o SE5 com outro alias para ser filtrado porque a funcao    Ё
				//Ё TemBxCanc() utilizara o SE5 sem filtro.							Ё
				//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				ChkFile("SE5",.F.,"SE5_TRB")

				DbSelectArea("SE5_TRB")

				cCondicao	:= "SE5_TRB->E5_FILIAL=='"+xFilial("SE5")+"' .And. DTOS(SE5_TRB->E5_DTDIGIT) >='"+DTOS(mv_par01)+"' .And. DTOS(SE5_TRB->E5_DTDIGIT) <= '"+DTOS(mv_par02)+"'"
				cChaveInd	:= "SE5_TRB->E5_FILIAL+DTOS(SE5_TRB->E5_DTDIGIT)+SE5_TRB->E5_PREFIXO+SE5_TRB->E5_NUMERO+SE5_TRB->E5_PARCELA+SE5_TRB->E5_TIPO+SE5_TRB->E5_CLIFOR+SE5_TRB->E5_LOJA+SE5_TRB->E5_SEQ"
				cArqTemp	:= CriaTrab(NIL,.F.)

				IndRegua("SE5_TRB",cArqTemp,cChaveInd,,cCondicao,OemToAnsi(STR0021)+cMensagem)  //"Gerando Movimentacao Bancaria..."
				nIndice := RetIndex("SE5","SE5_TRB")

				DbSelectArea("SE5_TRB")
				DbSetIndex(cArqTemp+OrdBagExt())
				DbSetOrder(nIndice+1)
				DbGotop()
			#ENDIF

			DbSelectArea("SE5_TRB")
			ProcRegua(LastRec())

			While Eof() == .F. .And. xFilial("SE5") == SE5_TRB->E5_FILIAL
				DbSelectArea("SE5_TRB")
				If SE5_TRB->E5_TIPO $ (MVPAGANT+MVRECANT) .Or. SE5_TRB->E5_TIPO $ MV_CPNEG .Or. SE5_TRB->E5_TIPO $ MV_CRNEG
					DbSelectArea("SE5_TRB")
					DbSkip()
					Loop
				EndIf
				If Empty(SE5_TRB->E5_NUMERO) .Or. Empty(SE5_TRB->E5_TIPODOC) .Or. !(SE5_TRB->E5_TIPODOC $ "VL/BA/CP") .Or. SE5_TRB->E5_RECPAG == "P"
					DbSelectArea("SE5_TRB")
					DbSkip()
					Loop
				EndIf
				If SE5_TRB->E5_SITUACA == "C"
					DbSelectArea("SE5_TRB")
					DbSkip()
					Loop
				EndIf

				cChvLaco := SE5_TRB->(E5_FILIAL+DTOS(E5_DTDIGIT)+E5_PREFIXO+E5_NUMERO+E5_PARCELA+E5_TIPO+E5_CLIFOR+E5_LOJA+E5_SEQ)

				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Posiciona o SE5 pois o alias do laco e o SE5_TRB.                Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				DbSelectArea("SE5")
				DbSetOrder(7)
				DbSeek(xFilial("SE5")+SE5_TRB->(E5_PREFIXO+E5_NUMERO+E5_PARCELA+E5_TIPO+E5_CLIFOR+E5_LOJA+E5_SEQ))

				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Pomto de entrada para filtragem de tipos do SE5.                 Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				If lFiltraSe5
					If !(Execblock("FILTSE5",.F.,.F.))
						DbSelectArea("SE5_TRB")
						DbSkip()
						Loop
					EndIf
				EndIf

				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Verifica se existe estorno para esta baixa                       Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				If TemBxCanc(SE5->(E5_PREFIXO+E5_NUMERO+E5_PARCELA+E5_TIPO+E5_CLIFOR+E5_LOJA+E5_SEQ))
					DbSelectArea("SE5_TRB")
					DbSkip()
					Loop
				EndIf

				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Posiciona no titulo a receber                                    Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				DbSelectArea("SE1")
				DbSetOrder(1)
				If DbSeek(xFilial()+SE5_TRB->(E5_PREFIXO+E5_NUMERO+E5_PARCELA+E5_TIPO))
					DbSelectArea("SA1")
					DbSeek(xFilial()+SE5_TRB->E5_CLIFOR+SE5_TRB->E5_LOJA)
					DbSelectArea("SE5")
					GravaRegistro(aConteudo,nHdlArq)
				EndIf

				DbSelectArea("SE5_TRB")
				While Eof() == .F. .And.cChvLaco == SE5_TRB->(E5_FILIAL+DTOS(E5_DTDIGIT)+E5_PREFIXO+E5_NUMERO+E5_PARCELA+E5_TIPO+E5_CLIFOR+E5_LOJA+E5_SEQ)
					IncProc("Titulo "+SE5_TRB->E5_PREFIXO+"-"+SE5_TRB->E5_NUMERO+"-"+SE5_TRB->E5_PARCELA+"-"+SE5_TRB->E5_TIPO)

					DbSkip()
				EndDo
			EndDo

			DbSelectArea("SE5_TRB")
			DbCloseArea()
			DbSelectArea("SE5")
			Set Filter To
			RetIndex("SE5")
			DbSetOrder(1)
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Movimentacao das Baixas a Pagar 						     Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "BBP"
			#IFDEF TOP
				If TcSrvType() != "AS/400"
					cQuery	:= "SELECT * FROM " + RetSqlName("SE5") + " WHERE "
					cQuery	+= " E5_FILIAL = '" + xFilial("SE5") + "'"
					cQuery += " AND E5_DTDIGIT >= '" + DTOS(mv_par01) + "'"
					cQuery += " AND E5_DTDIGIT <= '" + DTOS(mv_par02) + "'"
					cQuery += " AND D_E_L_E_T_ <> '*'"

					//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
					//Ё Montagem da ordem para Informix                                 Ё
					//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
					If UPPER(TcGetDB()) == "INFORMIX"
						cChaveInformix := ""
						For nLaco:=1 To FCount()
							If AllTrim(FieldName(nLaco)) $ ".E5_FILIAL.E5_DTDIGIT.E5_PREFIXO.E5_NUMERO.E5_PARCELA.E5_TIPO.E5_CLIFOR.E5_LOJA.E5_SEQ."
								cChaveInformix += (StrZero(nLaco,2)+",")
							EndIf
						Next
						//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
						//Ё Descarta a ultima virgula da ordem gerada                       Ё
						//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
						cChaveInformix := SubStr(cChave,1,Len(cChave)-1)
					Else
						cChaveInformix := "E5_FILIAL, E5_DTDIGIT, E5_PREFIXO, E5_NUMERO, E5_PARCELA, E5_TIPO, E5_CLIFOR, E5_LOJA, E5_SEQ"
					EndIf

					cQuery += " ORDER BY " + cChaveInformix

					cQuery := ChangeQuery(cQuery)
					DbUseArea(.T., "TOPCONN", TCGenQry(,,cQuery), 'SE5_TRB', .F., .T.)
					For nLaco:=1 to Len(aStruSE5)
						If aStruSE5[nLaco,2] != 'C'
							TCSetField('SE5_TRB', aStruSE5[nLaco,1], aStruSE5[nLaco,2],aStruSE5[nLaco,3],aStruSE5[nLaco,4])
						EndIf
					Next
				Else
					//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
					//Ё Abre o SE5 com outro alias para ser filtrado porque a funcao    Ё
					//Ё TemBxCanc() utilizara o SE5 sem filtro.							Ё
					//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
					ChkFile("SE5",.F.,"SE5_TRB")

					DbSelectArea("SE5_TRB")

					cCondicao	:= "SE5_TRB->E5_FILIAL=='"+xFilial("SE5")+"' .And. DTOS(SE5_TRB->E5_DTDIGIT) >='"+DTOS(mv_par01)+"' .And. DTOS(SE5_TRB->E5_DTDIGIT) <= '"+DTOS(mv_par02)+"'"
					cChaveInd	:= "SE5_TRB->E5_FILIAL+DTOS(SE5_TRB->E5_DTDIGIT)+SE5_TRB->E5_PREFIXO+SE5_TRB->E5_NUMERO+SE5_TRB->E5_PARCELA+SE5_TRB->E5_TIPO+SE5_TRB->E5_CLIFOR+SE5_TRB->E5_LOJA+SE5_TRB->E5_SEQ"
					cArqTemp	:= CriaTrab(NIL,.F.)

					IndRegua("SE5_TRB",cArqTemp,cChaveInd,,cCondicao,OemToAnsi(STR0021)+cMensagem)  //"Gerando Movimentacao Bancaria..."
					nIndice := RetIndex("SE5","SE5_TRB")

					DbSelectArea("SE5_TRB")
					DbSetIndex(cArqTemp+OrdBagExt())
					DbSetOrder(nIndice+1)
					DbGotop()
				EndIf
			#ELSE
				//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Abre o SE5 com outro alias para ser filtrado porque a funcao    Ё
				//Ё TemBxCanc() utilizara o SE5 sem filtro.						    Ё
				//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				ChkFile("SE5",.F.,"SE5_TRB")

				DbSelectArea("SE5_TRB")

				cCondicao	:= "SE5_TRB->E5_FILIAL=='"+xFilial("SE5")+"' .And. DTOS(SE5_TRB->E5_DTDIGIT) >='"+DTOS(mv_par01)+"' .And. DTOS(SE5_TRB->E5_DTDIGIT) <= '"+DTOS(mv_par02)+"'"
				cChaveInd	:= "SE5_TRB->E5_FILIAL+DTOS(SE5_TRB->E5_DTDIGIT)+SE5_TRB->E5_PREFIXO+SE5_TRB->E5_NUMERO+SE5_TRB->E5_PARCELA+SE5_TRB->E5_TIPO+SE5_TRB->E5_CLIFOR+SE5_TRB->E5_LOJA+SE5_TRB->E5_SEQ"
				cArqTemp	:= CriaTrab(NIL,.F.)

				IndRegua("SE5_TRB",cArqTemp,cChaveInd,,cCondicao,OemToAnsi(STR0021)+cMensagem)  //"Gerando Movimentacao Bancaria..."
				nIndice := RetIndex("SE5","SE5_TRB")

				DbSelectArea("SE5_TRB")
				DbSetIndex(cArqTemp+OrdBagExt())
				DbSetOrder(nIndice+1)
				DbGotop()
			#ENDIF

			DbSelectArea("SE5_TRB")
			ProcRegua(LastRec())

			While Eof() == .F. .And. xFilial("SE5") == SE5_TRB->E5_FILIAL
				DbSelectArea("SE5_TRB")
				If SE5_TRB->E5_TIPO $ (MVPAGANT+MVRECANT) .Or. SE5_TRB->E5_TIPO $ MV_CPNEG .Or. SE5_TRB->E5_TIPO $ MV_CRNEG
					DbSelectArea("SE5_TRB")
					DbSkip()
					Loop
				EndIf
				If Empty(SE5_TRB->E5_NUMERO) .Or. Empty(SE5_TRB->E5_TIPODOC) .Or. !(SE5_TRB->E5_TIPODOC $ "VL/BA/CP") .Or. SE5_TRB->E5_RECPAG == "R"
					DbSelectArea("SE5_TRB")
					DbSkip()
					Loop
				EndIf
				If SE5_TRB->E5_SITUACA == "C"
					DbSelectArea("SE5_TRB")
					DbSkip()
					Loop
				EndIf

				cChvLaco := SE5_TRB->(E5_FILIAL+DTOS(E5_DTDIGIT)+E5_PREFIXO+E5_NUMERO+E5_PARCELA+E5_TIPO+E5_CLIFOR+E5_LOJA+E5_SEQ)

				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Posiciona o SE5 pois o alias do laco e o SE5_TRB.                Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				DbSelectArea("SE5")
				DbSetOrder(7)
				DbSeek(xFilial("SE5")+SE5_TRB->(E5_PREFIXO+E5_NUMERO+E5_PARCELA+E5_TIPO+E5_CLIFOR+E5_LOJA+E5_SEQ))

				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Pomto de entrada para filtragem de tipos do SE5.                 Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				If lFiltraSe5
					If !(Execblock("FILTSE5",.F.,.F.))
						DbSelectArea("SE5_TRB")
						DbSkip()
						Loop
					EndIf
				EndIf

				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Verifica se existe estorno para esta baixa                       Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				If TemBxCanc(SE5->(E5_PREFIXO+E5_NUMERO+E5_PARCELA+E5_TIPO+E5_CLIFOR+E5_LOJA+E5_SEQ))
					DbSelectArea("SE5_TRB")
					DbSkip()
					Loop
				EndIf

				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Posiciona no titulo a pagar                                      Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				DbSelectArea("SE2")
				DbSetOrder(1)
				If DbSeek(xFilial()+SE5_TRB->(E5_PREFIXO+E5_NUMERO+E5_PARCELA+E5_TIPO+E5_CLIFOR+E5_LOJA))
					DbSelectArea("SA2")
					DbSeek(xFilial()+SE5_TRB->E5_CLIFOR+SE5_TRB->E5_LOJA)
					DbSelectArea("SE5")
					GravaRegistro(aConteudo,nHdlArq)
				EndIf

				DbSelectArea("SE5_TRB")
				While Eof() == .F. .And.cChvLaco == SE5_TRB->(E5_FILIAL+DTOS(E5_DTDIGIT)+E5_PREFIXO+E5_NUMERO+E5_PARCELA+E5_TIPO+E5_CLIFOR+E5_LOJA+E5_SEQ)
					IncProc("Titulo "+SE5_TRB->E5_PREFIXO+"-"+SE5_TRB->E5_NUMERO+"-"+SE5_TRB->E5_PARCELA+"-"+SE5_TRB->E5_TIPO)

					DbSkip()
				EndDo
			EndDo

			DbSelectArea("SE5_TRB")
			DbCloseArea()
			DbSelectArea("SE5")
			Set Filter To
			RetIndex("SE5")
			DbSetOrder(1)
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё NF Sa║da                                                     Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "SF2"
			DbSelectArea( "SF2")
			DbSeek(xFilial())

			ProcRegua(LastRec())

			While !Eof() .and. F2_FILIAL == xFilial()
				#IFDEF SHELL
					If ( SF2->F2_CANCEL == "S" )
						SF2->(DbSkip())
						Loop
					EndIf
				#ENDIF

				If SF2->F2_EMISSAO < dDataIni .or. SF2->F2_EMISSAO > dDataFim
					DbSkip()
					Loop
				EndIf

				SD2->(DbSetOrder(3))
				SD2->(DbSeek(xFilial("SD2")+SF2->F2_DOC+SF2->F2_SERIE))
				nItMateriais:=0
				While SD2->(!eof()).and.SD2->D2_FILIAL+SD2->D2_DOC+SD2->D2_SERIE==xFilial("SF2")+SF2->F2_DOC+SF2->F2_SERIE
					#IFDEF SHELL
						If ( SD2->D2_CANCEL == "S" )
							SD2->(DbSkip())
							Loop
						EndIf
					#ENDIF

					If Empty(SD2->D2_CODISS)
						nItMateriais++
						Exit
					Endif
					SD2->(DbSkip())
				EndDo
				If nItMateriais==0
					DbSkip()
					Loop
				Endif
				SA1->(DbSeek(xFilial("SA1")+SF2->F2_CLIENTE+SF2->F2_LOJA))
				SA4->(DbSeek(xFilial("SA4")+SF2->F2_TRANSP))
				SE1->(DbSeek(xFilial("SE1")+SF2->F2_SERIE+SF2->F2_DOC))
				GravaRegistro(aConteudo,nHdlArq)

				DbSelectArea("SF2")
				DbSkip()

				IncProc()
			EndDo
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Itens de NF Sa║da                                            Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "SD2"
			DbSelectArea( "SD2")
			DbSetOrder(5)
			DbSeek(xFilial()+dTos(dDataIni),.T.)

			ProcRegua(LastRec())

			While !Eof().and.D2_FILIAL==xFilial().And.SD2->D2_EMISSAO<=dDataFim
				If SD2->D2_EMISSAO < dDataIni .or. SD2->D2_EMISSAO > dDataFim .or. !Empty(SD2->D2_CODISS)
					DbSkip()
					Loop
				Endif

				#IFDEF SHELL
					If ( SD2->D2_CANCEL == "S" )
						SD2->(DbSkip())
						Loop
					EndIf
				#ENDIF

				SF4->(DbSeek(xFilial("SF4")+SD2->D2_TES))
				SB1->(DbSeek(xFilial("SB1")+SD2->D2_COD))
				SF2->(DbSeek(xFilial("SF2")+SD2->D2_DOC+SD2->D2_SERIE))
				SA1->(DbSeek(xFilial("SA1")+SD2->D2_CLIENTE+SD2->D2_LOJA))
				SA4->(DbSeek(xFilial("SA4")+SF2->F2_TRANSP))
				SE1->(DbSeek(xFilial("SE1")+SD2->D2_SERIE+SD2->D2_DOC))

				GravaRegistro(aConteudo,nHdlArq)

				DbSelectArea("SD2")
				DbSkip()

				IncProc()
			EndDo
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Complemento de Nf Sa║da                                      Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "SFA"
			DbSelectArea("SF2")
			DbSeek(xFilial())

			ProcRegua(LastRec())

			While !Eof() .and. F2_FILIAL == xFilial()
				If SF2->F2_EMISSAO < dDataIni .or. SF2->F2_EMISSAO > dDataFim
					DbSkip()
					Loop
				Endif

				#IFDEF SHELL
					If ( SF2->F2_CANCEL == "S" )
						SF2->( DbSkip() )
						Loop
					EndIf
				#ENDIF

				SD2->(DbSetOrder(3))
				SD2->(DbSeek(xFilial("SD2")+SF2->F2_DOC+SF2->F2_SERIE))
				nItMateriais:=0
				While SD2->(!eof()).and.SD2->D2_FILIAL+SD2->D2_DOC+SD2->D2_SERIE==xFilial("SF2")+SF2->F2_DOC+SF2->F2_SERIE
					#IFDEF SHELL
						If ( SD2->D2_CANCEL == "S" )
							SD2->(DbSkip())
							Loop
						EndIf
					#ENDIF

					If Empty(SD2->D2_CODISS)
						nItMateriais++
						Exit
					Endif
					SD2->(DbSkip())
				EndDo
				If nItMateriais==0
					DbSkip()
					Loop
				Endif

				SA1->(DbSeek(xFilial("SA1")+SF2->F2_CLIENTE+SF2->F2_LOJA))
				SA4->(DbSeek(xFilial("SA4")+SF2->F2_TRANSP))
				SE1->(DbSeek(xFilial("SE1")+SF2->F2_SERIE+SF2->F2_DOC))

				GravaRegistro(aConteudo,nHdlArq)

				DbSelectArea("SF2")
				DbSkip()

				IncProc()
			EndDo
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Nota fiscal de servi┤o                                       Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "SFB"
			DbSelectArea("SF2")
			DbSeek(xFilial())

			ProcRegua(LastRec())

			While !Eof() .and. F2_FILIAL == xFilial()
				If SF2->F2_EMISSAO < dDataIni .or. SF2->F2_EMISSAO > dDataFim
					DbSkip()
					Loop
				Endif

				#IFDEF SHELL
					If ( SF2->F2_CANCEL == "S" )
						SF2->( DbSkip() )
						Loop
					EndIf
				#ENDIF

				SD2->(DbSetOrder(3))
				SD2->(DbSeek(xFilial("SD2")+SF2->F2_DOC+SF2->F2_SERIE))
				nItServico:=0
				While SD2->(!eof()).and.SD2->D2_FILIAL+SD2->D2_DOC+SD2->D2_SERIE==xFilial()+SF2->F2_DOC+SF2->F2_SERIE
					#IFDEF SHELL
						If ( SD2->D2_CANCEL == "S" )
							SD2->(DbSkip())
							Loop
						EndIf
					#ENDIF
					If !Empty(SD2->D2_CODISS)
						nItServico++
						Exit
					Endif
					SD2->(DbSkip())
				EndDo
				If nItServico==0
					DbSkip()
					Loop
				EndIf

				SF4->(DbSeek(xFilial("SF4")+SD2->D2_TES))
				SA1->(DbSeek(xFilial("SA1")+SF2->F2_CLIENTE+SF2->F2_LOJA))
				SA4->(DbSeek(xFilial("SA4")+SF2->F2_TRANSP))
				SE1->(DbSeek(xFilial("SE1")+SF2->F2_SERIE+SF2->F2_DOC))

				GravaRegistro(aConteudo,nHdlArq)

				DbSelectArea("SF2")
				DbSkip()

				IncProc()
			EndDo
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Itens de Nota fiscal de servi┤o                              Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "SDA"
			DbSelectArea( "SD2")
			DbSetOrder(5)
			DbSeek(xFilial()+dtos(dDataIni),.T.)

			ProcRegua(LastRec())

			While !Eof().and.D2_FILIAL==xFilial().And.SD2->D2_EMISSAO<=dDataFim
				#IFDEF SHELL
					If ( D2_CANCEL == "S" )
						DbSkip()
						Loop
					EndIf
				#ENDIF
				If SD2->D2_EMISSAO < dDataIni .or. SD2->D2_EMISSAO > dDataFim .or. Empty(SD2->D2_CODISS)
					DbSkip()
					Loop
				EndIf

				SB1->(DbSeek(xFilial()+SD2->D2_COD))
				SF2->(DbSeek(xFilial()+SD2->D2_DOC+SD2->D2_SERIE))
				SA1->(DbSeek(xFilial()+SF2->F2_CLIENTE+SF2->F2_LOJA))
				SE1->(DbSeek(xFilial()+SF2->F2_SERIE+SF2->F2_DOC))

				GravaRegistro(aConteudo,nHdlArq)

				DbSelectArea("SD2")
				DbSkip()

				IncProc()
			EndDo
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Notas fiscais de Entrada                                     Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "SF1"
			DbSelectArea("SF1")
			DbSeek(xFilial())

			ProcRegua(LastRec())

			While !Eof() .and. F1_FILIAL == xFilial()
				#IFDEF SHELL
					If ( F1_CANCEL == "S" )
						DbSkip()
						Loop
					EndIf
				#ENDIF
				If SF1->F1_DTDIGIT < dDataIni .or. SF1->F1_DTDIGIT > dDataFim
					DbSkip()
					Loop
				EndIf

				If lFiltSf1
					If ! (Execblock("FILTSF1",.f.,.f.))
						dbSkip()
						Loop
					Endif
				Endif
				SD1->(DbSeek(xFilial("SD1")+SF1->F1_DOC+SF1->F1_SERIE))
				SA2->(DbSeek(xFilial("SA2")+SF1->F1_FORNECE+SF1->F1_LOJA))
				SE2->(DbSeek(xFilial("SE2")+SF1->F1_SERIE+SF1->F1_DOC))

				GravaRegistro(aConteudo,nHdlArq)

				DbSelectArea("SF1")
				DbSkip()

				IncProc()
			EndDo
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Itens de Nota fiscal de Entrada 							 Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "SD1"
			DbSelectArea("SF1")
			DbSetOrder(1)

			DbSelectArea("SD1")
			DbSeek(xFilial())

			ProcRegua(LastRec())

			While !Eof() .and. D1_FILIAL == xFilial()
				#IFDEF SHELL
					If ( SD1->D1_CANCEL == "S" )
						Loop
						DbSkip()
					EndIf
				#ENDIF
				If SD1->D1_DTDIGIT < dDataIni .or. SD1->D1_DTDIGIT > dDataFim
					DbSkip()
					Loop
				EndIf

				SF4->(DbSeek(xFilial("SF4")+SD1->D1_TES))
				SB1->(DbSeek(xFilial("SB1")+SD1->D1_COD))
				SF1->(DbSeek(xFilial("SF1")+SD1->D1_DOC+SD1->D1_SERIE+SD1->D1_FORNECE+SD1->D1_LOJA))

				If lFiltSD1
					If !(Execblock("FILTSD1",.f.,.f.))
						DbSkip()
						Loop
					EndIf
				EndIf

				SA2->(DbSeek(xFilial("SA2")+SF1->F1_FORNECE+SF1->F1_LOJA))
				SE2->(DbSeek(xFilial("SE2")+SF1->F1_SERIE+SF1->F1_DOC))

				GravaRegistro(aConteudo,nHdlArq)

				DbSelectArea("SD1")
				DbSkip()
				IncProc()
			EndDo
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Registro de Controle de Estoque (Entradas)					 Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "SDB"
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Monta registro de NFs de Entradas.        					 Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			DbSelectArea("SF1")
			DbSetOrder(1)
			DbSeek(xFilial(),.F.)

			While !Eof() .And. xFilial()==SF1->F1_FILIAL
				#IFDEF SHELL
					If ( SF1->F1_CANCEL == "S" )
						DbSkip()
						Loop
					EndIf
				#ENDIF
				If F1_DTDIGIT < dDataIni .or. F1_DTDIGIT > dDataFim
					DbSkip()
					Loop
				Endif
				If lFiltSf1
					If !(Execblock("FILTSF1",.f.,.f.))
						DbSkip()
						Loop
					EndIf
				EndIf
				cSeek:=SF1->F1_DOC+SF1->F1_SERIE+SF1->F1_FORNECE+SF1->F1_LOJA
				DbSelectArea( "SD1")
				DbSetOrder(1)
				DbSeek(xFilial()+cSeek,.F.)
				ProcRegua(LastRec())

				While !Eof().and.D1_FILIAL+D1_DOC+D1_SERIE+D1_FORNECE+D1_LOJA==xFilial()+cSeek
					#IFDEF SHELL
						If ( SD1->D1_CANCEL == "S" )
							DbSkip()
							Loop
						EndIf
					#ENDIF
					If D1_DTDIGIT < dDataIni .or. D1_DTDIGIT > dDataFim
						DbSkip()
						Loop
					EndIf
					If lFiltSd1
						If ! (Execblock("FILTSD1",.f.,.f.))
							dbSkip()
							Loop
						EndIf
					EndIf
					SB1->(DbSeek(xFilial("SB1")+SD1->D1_COD))
					SF4->(DbSeek(xFilial("SF4")+SD1->D1_TES))
					cTipDoc :="001"
					cEspecie:=SF1->F1_ESPECIE
					cDocum	:=SD1->D1_DOC
					cSerie	:=SD1->D1_SERIE
					dData	:=dataint(SD1->D1_DTDIGIT)
					nQuant	:=SD1->D1_QUANT
					nVUnit  :=SD1->D1_VUNIT
					nCusto  :=SD1->D1_CUSTO
					cConta  :=SD1->D1_CONTA
					If cTabela = "TM"
						cTipOper:=Val(SD1->D1_TES)
					Else
						cTipOper:=VerTipOp("E",SD1->D1_TIPO,SD1->D1_CF,SD1->D1_TOTAL)
					Endif
					cLocal  :=If(! Empty(SD1->D1_CC), SD1->D1_CC, SD1->D1_LOCAL)

					If SF4->F4_ESTOQUE = "S"		// Somente registros que atualizam estoque
						GravaRegistro(aConteudo,nHdlArq)
					Endif

					DbSelectArea("SD1")
					DbSkip()
					IncProc()
				EndDo
				DbSelectArea("SF1")
				DbSkip()
			EndDo

			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Monta registro de NFs de Saidas.          					 Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			DbSelectArea("SF2")
			DbSetOrder(1)
			DbSeek(xFilial(),.F.)

			While !Eof() .And. xFilial()==SF2->F2_FILIAL
				#IFDEF SHELL
					If ( SF2->F2_CANCEL == "S" )
						DbSkip()
						Loop
					EndIf
				#ENDIF

				If F2_EMISSAO < dDataIni .or. F2_EMISSAO > dDataFim
					DbSkip()
					Loop
				Endif
				cSeek:=SF2->F2_DOC+SF2->F2_SERIE+SF2->F2_CLIENTE+SF2->F2_LOJA

				DbSelectArea( "SD2")
				DbSetOrder(3)
				DbSeek(xFilial()+cSeek,.F.)
				ProcRegua(LastRec())

				While !Eof() .and. D2_FILIAL+D2_DOC+D2_SERIE+D2_CLIENTE+D2_LOJA == xFilial()+cSeek
					#IFDEF SHELL
						If ( SD2->D2_CANCEL == "S" )
							DbSkip()
							Loop
						EndIf
					#ENDIF

					If D2_EMISSAO<dDataIni.or.D2_EMISSAO>dDataFim.or.!Empty(D2_CODISS).or.D2_TOTAL<0
						DbSkip()
						Loop
					Endif

					cEspecie:=SF2->F2_ESPECIE

					SB1->(DbSeek(xFilial("SB1")+SD2->D2_COD))
					SF4->(DbSeek(xFilial("SF4")+SD2->D2_TES))
					cTipDoc	:="001"
					cDocum	:=SD2->D2_DOC
					cSerie	:=SD2->D2_SERIE
					nQuant	:=SD2->D2_QUANT
					dData	:=dataint(SD2->D2_EMISSAO)
					nVUnit  :=SD2->D2_PRCVEN
					nCusto  :=SD2->D2_CUSTO1
					cConta  :=SD2->D2_CONTA
					If cTabela = "TM"
						cTipOper:=VAL(SD2->D2_TES)
					Else
						cTipOper:=VerTipOp("S",SD2->D2_TIPO,SD2->D2_CF,SD2->D2_TOTAL)
					Endif
					cLocal  :=If(Empty(SB1->B1_CC), SD2->D2_LOCAL, SB1->B1_CC)

					If SF4->F4_ESTOQUE = "S"		// Somente registros que atualizam estoque
						GravaRegistro(aConteudo,nHdlArq)
					Endif

					DbSelectArea("SD2")
					DbSkip()

					IncProc()
				EndDo
				DbSelectArea("SF2")
				DbSkip()
			EndDo
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Monta registro de Movimentacoes Internas.  				     Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			DbSelectArea("SD3")
			DbSeek( xFilial() )
			ProcRegua(LastRec())

			While !Eof() .and. D3_FILIAL == xFilial()
				If D3_EMISSAO<dDataIni.or.D3_EMISSAO>dDataFim
					DbSkip()
					Loop
				Endif

				SB1->(DbSeek(xFilial("SB1")+SD3->D3_COD))
				SF5->(DbSeek(xFilial("SB1")+SD3->D3_TM))
				cTipDoc	:="008"
				If SD3->D3_TM <= "500"
					cEspecie:="DEV"
				Else
					cEspecie:="REQ"
				Endif
				cDocum	:=SD3->D3_DOC
				cSerie	:=Space(3)
				nQuant	:=SD3->D3_QUANT
				dData	:=dataint(SD3->D3_EMISSAO)
				nVUnit  :=SD3->D3_CUSTO1/SD3->D3_QUANT
				nCusto  :=SD3->D3_CUSTO1
				cConta  :=SD3->D3_CONTA
				If cTabela = "TM"
					cTipOper:=Val("9" + SD3->D3_TM)
				Else
					cTipOper:="023"
				Endif
				cLocal  :=If(Empty(SD3->D3_CC), SD3->D3_LOCAL, SD3->D3_CC)

				GravaRegistro(aConteudo,nHdlArq)

				DbSelectArea("SD3")
				DbSkip()

				IncProc()
			EndDo
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Registro de Produtos										 Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "SB1"
			DbSelectArea("SB1")
			DbSeek(xFilial())

			ProcRegua(LastRec())

			While !Eof() .and. B1_FILIAL == xFilial()
				GravaRegistro(aConteudo,nHdlArq)
				DbSelectArea("SB1")
				DbSkip()
				IncProc()
			EndDo
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Registro de Invent═rio 										 Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "SB2"
			DbSelectArea("SB6")
			cIndSB6:=Substr(CriaTrab(NIL,.F.),1,7)+"T"
			#IFDEF TOP
				cChave := "B6_FILIAL+B6_PRODUTO+B6_Local+B6_TIPO+B6_DTDIGIT"
				cQuery := 'DtoS(B6_DTDIGIT)<="'+DtoS(dDataFim+1)+'"'
			#ELSE
				cChave := "B6_FILIAL+B6_PRODUTO+B6_Local+B6_TIPO+DTOS(B6_DTDIGIT)"
				cQuery := 'DtoS(B6_DTDIGIT)<="'+DtoS(dDataFim+1)+'"'
			#ENDIF
			IndRegua("SB6",cIndSB6,cChave,,cQuery,STR0013) // "Selecionando Poder Terceiros..."
			nIndSB6:=RetIndex("SB6")
			#IFNDEF TOP
				dbSetIndex(cIndSB6+OrdBagExt())
			#ENDIF
			DbSetOrder(nIndSB6 + 1)
			DbSelectArea("SB1")
			DbSeek(xFilial() )
			ProcRegua(LastRec())

			While !Eof() .and. B1_FILIAL == xFilial()
				If !Empty(B1_CODISS)
					DbSkip()
					Loop
				Endif
				DbSelectArea("SB2")
				DbSeek(xFilial()+SB1->B1_COD)
				While !Eof() .and. B2_FILIAL+B2_COD==xFilial()+SB1->B1_COD
					If B2_Local==cLocProc
						DbSkip()
						Loop
					Endif
					aSalAtu:=CalcEst(SB1->B1_COD,SB2->B2_Local,dDataFim+1)
					If aSalAtu[1] + aSalAtu[2] > 0.00
						cOperacao:="1"
						GravaRegistro(aConteudo,nHdlArq)
					Endif
					DbSkip()
				EndDo
				DbSelectArea("SB1")
				DbSkip()
				IncProc()
			EndDo

			DbSeek(xFilial())
			ProcRegua(LastRec())

			While !Eof() .and. B1_FILIAL == xFilial()
				If !Empty(B1_CODISS)
					DbSkip()
					Loop
				Endif
				DbSelectArea("SB2")
				DbSeek(xFilial()+SB1->B1_COD)
				While !Eof() .and. B2_FILIAL+B2_COD==xFilial()+SB1->B1_COD
					If B2_Local=cLocProc
						DbSkip()
						Loop
					Endif
					aSalAtu:=SaldoTerc(SB1->B1_COD,SB2->B2_Local,"T",dDataFim+1)
					If aSalAtu[1] + aSalAtu[2] > 0.00
						cOperacao:="2"
						GravaRegistro(aConteudo,nHdlArq)
					Endif
					DbSkip()
				EndDo

				DbSelectArea("SB1")
				DbSkip()
				IncProc()
			EndDo
			DbSelectArea("SB6")
			RetIndex("SB6")
			Set Filter to
			If File(cIndSB6+OrdBagExt())
				fErase(cIndSB6)
			EndIf
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Registro de Dados de Insumos Relacionados                    Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "SG1"
			DbSelectArea("SG1")
			DbSetOrder(1)
			DbSelectArea( "SB1")
			DbSetOrder(1)
			DbSeek(xFilial())
			ProcRegua(LastRec())

			While !Eof() .and. B1_FILIAL == xFilial()
				DbSelectArea("SG1")
				If DbSeek(xFilial()+SB1->B1_COD)
					GravaRegistro(aConteudo,nHdlArq)
				EndIf
				DbSelectArea("SB1")
				DbSkip()
				IncProc()
			EndDo
		ElseIf cFile == "SGA" .Or. cFile == "SG5"		// SG5 = Embalagens que estao na estrutura
			DbSelectArea( "SB1")
			DbSetOrder(1)
			DbSelectArea("SG1")
			DbSetOrder(1)
			DbSeek( xFilial() )
			ProcRegua(LastRec())

			While !Eof() .and. G1_FILIAL == xFilial()
				DbSelectArea("SB1")
				If DbSeek(xFilial()+SG1->G1_COMP)
					GravaRegistro(aConteudo,nHdlArq)
				Endif
				DbSelectArea("SG1")
				DbSkip()
				IncProc()
			EndDo
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Registro de Embalagens                                       Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ElseIf cFile == "SB5"
			DbSelectArea( "SB5")
			DbSeek( xFilial() )
			ProcRegua(LastRec())

			While !Eof() .and. B5_FILIAL == xFilial()
				DbSelectArea("SB1")
				DbSeek(xFilial()+SB5->B5_COD)
				GravaRegistro(aConteudo,nHdlArq)
				DbSelectArea("SB5")
				DbSkip()
				IncProc()
			EndDo

		ElseIf cFile == "SN4"
			DbSelectArea( "SN4")
			DbSeek(xFilial())
			ProcRegua(LastRec())

			While !Eof() .and. N4_FILIAL == xFilial()
				If SN4->N4_DATA < mv_par15 .or. SN4->N4_DATA > mv_par16
					DbSkip()
					Loop
				Endif
				GravaRegistro(aConteudo,nHdlArq)
				DbSkip()
				IncProc()
			Enddo
		ElseIf cFile == "SN1"
			DbSelectArea( "SN1")
			DbSeek( xFilial() )
			ProcRegua(LastRec())

			While !Eof() .and. N1_FILIAL == xFilial()
				If 	! Empty(SN1->N1_BAIXA) .And.;
						(Year(SN1->N1_BAIXA) + 5) > (Year(mv_par15) + 5)
					DbSelectArea("SN1")
					DbSkip()
					Loop
				Endif
				DbSelectArea("SN4")
				DbSeek(xFilial()+SN1->N1_CBASE+SN1->N1_ITEM)
				DbSelectArea("SN3")
				DbSeek(xFilial()+SN1->N1_CBASE+SN1->N1_ITEM)
				DbSelectArea("SN1")
				GravaRegistro(aConteudo,nHdlArq)
				DbSelectArea("SN1")
				DbSkip()
				IncProc()
			EndDo

		ElseIf cFile == "SRD"
			cAnoMesI := AllTrim(STR(YEAR(dDataIni)))+AllTrim(STRZERO(MONTH(dDataIni),2))
			cAnoMesA := AllTrim(STR(YEAR(dDataFim)))+AllTrim(STRZERO(MONTH(dDataFim),2))

			//-- Mudar para 13 porque o 13o. e gravado como mes 13
			If Subs(cAnoMesA,5,2) = '12'
				cAnoMesA := Subs(cAnoMesA,1,4)+'13'
			Endif

			DbSelectArea("SRD")
			DbSeek(xFilial())
			ProcRegua(LastRec())

			While !Eof() .and. SRD->RD_FILIAL == xFilial()
				If SRD->RD_DATARQ < cAnoMesI .or. SRD->RD_DATARQ > cAnoMesA .Or. ;
						SRD->RD_PD > "700"
					DbSkip()
					Loop
				Endif
				DbSelectArea("SRV")
				DbSeek(xFilial()+SRD->RD_PD)
				DbSelectArea("SRA")
				DbSeek(xFilial()+SRD->RD_MAT)
				DbSelectArea("SRD")
				GravaRegistro(aConteudo,nHdlArq)
				DbSelectArea("SRD")
				DbSkip()
				IncProc()
			Enddo

		ElseIf cFile == "SRA"
			DbSelectArea( "SRA")
			DbSeek( xFilial() )
			ProcRegua(LastRec())

			While !Eof() .and. RA_FILIAL == xFilial()
				DbSelectArea("SRJ")
				DbSeek(xFilial()+SRA->RA_CODFUNC)
				DbSelectArea("SRA")
				GravaRegistro(aConteudo,nHdlArq)
				DbSelectArea("SRA")
				DbSkip()
				IncProc()
			EndDo
		ElseIf cFile == "SA1"
			DbSelectArea( "SA1")
			DbSeek( xFilial() )
			ProcRegua(LastRec())

			While !Eof() .and. A1_FILIAL == xFilial()
				GravaRegistro(aConteudo,nHdlArq)
				DbSelectArea("SA1")
				DbSkip()
				IncProc()
			EndDo
		ElseIf cFile == "SA2"
			DbSelectArea( "SA2")
			DbSeek( xFilial() )
			ProcRegua(LastRec())

			While !Eof() .and. A2_FILIAL == xFilial()
				GravaRegistro(aConteudo,nHdlArq)
				DbSelectArea("SA2")
				DbSkip()
				IncProc()
			EndDo
		ElseIf cFile == "SA4"
			DbSelectArea( "SA4")
			DbSeek( xFilial() )
			ProcRegua(LastRec())

			While !Eof() .and. A4_FILIAL == xFilial()
				GravaRegistro(aConteudo,nHdlArq)
				DbSelectArea("SA4")
				DbSkip()
				IncProc()
			EndDo
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Arquivo de Trabalho de ExecBlock							 Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		Elseif cAlias == "TRB"
			nFile := Select("TRB")
			If nFile != 0
				DbSelectArea("TRB")
				dbGoTop()
				ProcRegua(LastRec())

				While ! Eof()

					AADD(aLayOut,"[TRB Tabelas fixas do sistema     ]              SX5     " +;
						Right(TRB->NUMTAB, 2) + "                     ")
					AADD(aLayOut,"DATA       D 08 0-DataInt(dDataBase)                                            ")
					AADD(aLayOut,"COD_TABEL  C 03 0-TRB->NUMTAB                                                   ")
					AADD(aLayOut,"COD_UTIL   C 28 0-TRB->COD                                                      ")
					AADD(aLayOut,"DESCRICAO  C 45 0-TRB->DESC                                                     ")

					cNomeArq := Trim(cDiret)+Right(NUMTAB, 2)+cFilAnt+StrZero(Day(dDataBase),2) + StrZero(Month(dDataBase),2) + ".TXT"
					nHdlArq  := MSFCREATE( cNomeArq)

					cTabAnt:=NUMTAB
					While !Eof().And.cTabAnt==NUMTAB
						If cFile = "SX5"
							GravaRegistro(aConteudo,nHdlArq)
						Else
							GravaRegistro(aConteudo,nHdlArq)
						Endif
						DbSelectArea("TRB")
						DbSkip()
						IncProc()
					EndDo
					fClose(nHdlArq)
					dbCommitall()
				Enddo
				//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
				//Ё Fecha arquivo de trabalho 									 Ё
				//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
				DbSelectArea("TRB")
				dbCloseArea()
			EndIf
		Endif
	EndIf

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Executa o ExecBlock de P╒s-processamento caso exista         Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If Len(cExecPos) > 2
		cExecPos:=Alltrim(Substr(cExecPos,1,10))
		If Existblock(cExecPos)
			ExecBlock(cExecPos,.F.,.F., { "POS", cFile })
		EndIf
	EndIf

	If cAlias # "TRB"
		dbCommitall()
		fClose(nHdlArq)
	EndIf

	Return(Nil)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    ЁGravaRegisЁ Autor Ё Mario Angelo          Ё Data Ё 20.03.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o ЁGrava uma determinado registro                              Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso      Ё GENERICO                                                   Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/

Function GravaRegistro( aConteudo,nHdlArq)

	Local i,nTamanho,cConteudo
	Local cLinha:="",nDec:=0
	Local cInteiro:="",cDecimal:=""
	Local cSvAlias:=Alias()
	Local cTipo := "" , cVar := ""
	Local lTipo := .F., lVar := .F.

	For i:=1 To Len(aConteudo)
		If ! Empty(Subs(aConteudo[i],13,1))
			nTamanho := INT(VAL(SubStr(aConteudo[i],13,3)))
		Else
			nTamanho := INT(VAL(SubStr(aConteudo[i],14,2)))
		Endif
		cConteudo	:= Trim(SUBSTR(aConteudo[i],19,60))
		cTipo		:= Substr(aConteudo[i],12,1)
		nDec		:= Val(Substr(aConteudo[i],17,1))

		If Empty( cConteudo)
			xCampo := Replicate(" ",nTamanho)
		Else
			xCampo := &(cConteudo)
		EndIf

		cVar	:= ValType((xCampo))
		lTipo	:= (cTipo == "N")
		lVar	:= (cVar  == "N")

		If lVar .And. lTipo													// Formata campos numericos
			If nDec > 0
				xCampo := StrZero(xCampo*(10^nDec),nTamanho)
			Else
				xCampo := StrZero(xCampo,nTamanho)
			Endif
		ElseIf (cVar$"C" .And. (Len(xCampo) < nTamanho))		// Caracter
			xCampo += Space(nTamanho-Len(xCampo))
		ElseIf lVar .And. !lTipo
			xCampo:=Str(xCampo,nTamanho)
		ElseIf Empty(xCampo) .And. cTipo=="D"
			xCampo:=Repl("0",Len(xCampo))
		Else
			xCampo += Space(nTamanho-Len(xCampo))
		EndIf

		If lTipo
			cLinha+=StrZero(Val(Left(xCampo,nTamanho)),nTamanho)
		Else
			cLinha+=SubStr(xCampo,1,nTamanho)
		EndIf
	Next
	fWrite(nHdlArq, cLinha + Chr(13)+Chr(10), Len(cLinha)+ 2)
	nTamReg:=Len(cLinha)

	Return(Nil)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o	 Ё Conta 	Ё Autor Ё Mario Angelo			Ё Data Ё 20.03.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o codigo da conta de um lancamento contabil		  Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso		 Ё GENERICO 												  Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function Conta()
	Local cConta:=" "
	If SI2->I2_DC $ "D"
		cConta := SI2->I2_DEBITO
	ElseIf SI2->I2_DC $ "C"
		cConta := SI2->I2_CREDITO
	Else
		If lFirst
			cConta := SI2->I2_DEBITO
		Else
			cConta := SI2->I2_CREDITO
		EndIf
	EndIf
	Return(cConta)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o	 Ё TipoLan	Ё Autor Ё Mario Angelo			Ё Data Ё 20.03.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o tipo do lancamento								  Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso		 Ё GENERICO 												  Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function TipoLan()
	Local cTipoLan:=" "
	If SI2->I2_DC $ "D"
		cTipoLan := "D"
	ElseIf SI2->I2_DC $ "C"
		ctipoLan := "C"
	Else
		If lFirst
			cTipoLan := "D"
		Else
			cTipoLan := "C"
		Endif
	Endif
	Return(cTipoLan)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o	 Ё ContraParЁ Autor Ё Mario Angelo			Ё Data Ё 20.03.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna a contra partida de um lancamento contabil.		  Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso		 Ё GENERICO 												  Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function ContraPar(lCentro)

	Local cConta:=" "

	DEFAULT lCentro := .F.

	If lCentro
		If SI2->I2_DC $ "D"
			cConta := SI2->I2_CCD
		ElseIf SI2->I2_DC $ "C"
			cConta := SI2->I2_CCC
		Else
			If lFirst
				cConta := SI2->I2_CCD
			Else
				cConta := SI2->I2_CCC
			EndIf
		EndIf
	Else
		If SI2->I2_DC $ "D"
			cConta := SI2->I2_CREDITO
		ElseIf SI2->I2_DC $ "C"
			cConta := SI2->I2_DEBITO
		Else
			If lFirst
				cConta := SI2->I2_CREDITO
			Else
				cConta := SI2->I2_DEBITO
			Endif
		Endif
	Endif
	Return(cConta)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o	 ЁCusto		Ё Autor Ё Mario Angelo			Ё Data Ё 20.03.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o centro de custo do lancamento.					  Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso		 Ё GENERICO 												  Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/

Function Custo()
	Local cCusto:=" "
	If SI2->I2_DC $ "DX"
		cCusto := SI2->I2_CCD
	Else
		cCusto := SI2->I2_CCC
	End
	Return(cCusto)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o	 Ё  DouC    Ё Autor Ё Mario Angelo			Ё Data Ё 20.03.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna a contra partida de um lancamento contabil.		  Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso		 Ё GENERICO 												  Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function DouC( nValor )
	Local cDC := "C"
	If nValor <= 0
		cDC := "D"
	End
	Return(cDC)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o	 ЁTotDebitosЁ Autor Ё Mario Angelo			Ё Data Ё 20.03.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna a total de debitos.                         		  Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso		 Ё GENERICO 												  Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function TotDebitos( nMes17Ini,nMes17Fim )

	Local nTotDebitos:=0
	Local cVar
	Local i

	For i:=nMes17Ini To nMes17Fim
		cVar := "SI1->I1_DEBM"+StrZero(i,2)
		nTotDebitos += &cVar
	Next
	Return(nTotDebitos)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    ЁTotCreditoЁ Autor Ё Mario Angelo          Ё Data Ё 20.03.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o total de creditos.                               Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso      Ё GENERICO                                                   Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function TotCreditos( nMes17Ini,nMes17Fim )

	Local nTotCreditos:=0
	Local i,cVar

	For i:=nMes17Ini To nMes17Fim
		cVar := "SI1->I1_CRDM"+StrZero(i,2)
		nTotCreditos+= &cVar
	Next

	Return(nTotCreditos)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё DataInt  Ё Autor Ё Mario Angelo          Ё Data Ё 20.03.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna a data.                                            Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso      Ё GENERICO                                                   Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function DataInt( dData )
	Local cData:=Space(8)

	If !Empty(dData)
		cData := Dtos(dData) // AAAAMMDD
		cData := Right(cData,2)+SubStr(cData,5,2)+Left(cData,4) // DDMMAAAA
	End

	Return(cData)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё VerCliForЁ Autor Ё Mario Angelo          Ё Data Ё 20.03.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna a o CGC do Cliente / Fornecedor Conforme caso      Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso      Ё GENERICO                                                   Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function VerCliFor(cAlias,cTipoNota,cChave)
	Local cCGC:=" "
	If cAlias=="SF2"
		If cTipoNota$"DB"
			SA2->(DbSeek(xFilial("SA2")+cChave))
			cCGC:=SA2->A2_CGC
		Else
			SA1->(DbSeek(xFilial("SA1")+cChave))
			cCGC:=SA1->A1_CGC
		Endif
	Else
		If cTipoNota$"DB"
			SA1->(DbSeek(xFilial("SA1")+cChave))
			cCGC:=SA1->A1_CGC
		Else
			SA2->(DbSeek(xFilial("SA2")+cChave))
			cCGC:=SA2->A2_CGC
		Endif
	Endif

	Return(cCGC)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё VerCAT   Ё Autor Ё Mario Angelo          Ё Data Ё 20.03.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna a o CATEGORIA (PJ PF)                              Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso      Ё GENERICO                                                   Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function VerCAT(cAlias,cTipoNota)
	Local cCateg:=" "
	If cAlias=="SF2"
		cCateg:=IIf(cTipoNota$"DB","02","01")
	Else
		cCateg:=IIf(cTipoNota$"DB","01","02")
	Endif
	Return(cCateg)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё VerDAtA  Ё Autor Ё Mario Angelo          Ё Data Ё 20.03.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna a o Ultima data de atualizacao                     Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso      Ё GENERICO                                                   Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function VerDATA( cBem )
	Local cData:="",nReg:=0
	DbSelectArea("SN4")
	nReg:=RecNo()

	While SN4->N4_FILIAL == xFilial() .AND. SN4->N4_CBASE+SN4->N4_ITEM == cBem
		cData:=SN4->N4_DATA
		DbSkip()
	End
	dbGoTo(nReg)
	cData:=DataInt(cData)
	Return(cData)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё VerPD    Ё Autor Ё Mario Angelo          Ё Data Ё 20.03.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o Tipod de Provento /Desconto                      Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso      Ё GENERICO                                                   Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function VerPD(cCodPD)
	Local cPD:=" "
	If cCodPD < "400"
		cPD:="P"
	Else
		cPD:="D"
	End
	Return(cPD)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё fTipoFol Ё Autor Ё Mauro                 Ё Data Ё 01.08.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o Tipo de movimento na folha                       Ё╠╠
	╠╠Ё          Ё 001 = Mensalista                                           Ё╠╠
	╠╠Ё          Ё 002 = Semanalista                                          Ё╠╠
	╠╠Ё          Ё 003 = 13o. Salario                                         Ё╠╠
	╠╠Ё          Ё 004 = Ferias                                               Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠ЁSintaxe   Ё fTipoFol(cCodPd)                                           Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso      Ё GENERICO                                                   Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function fTipoFol(cCodPD)
	Local cTipfol:=" "

	If SRV->RV_REFFER = "S"
		cTipFol := '004'
	Elseif SRV->RV_REF13 = "S" .Or. SUBS(SRD->RD_DATARQ,5,2) = '13'
		cTipFol := '003'
	Elseif SRA->RA_TIPOPGT = 'S'
		cTipFol := '002'
	Else
		cTipFol := '001'
	Endif
	Return(cTipFol)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё  AbreArq Ё Autor Ё Paulo Boschetti       Ё Data Ё 02/09/93 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Abre arquivos utilizados                                   Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠ЁUso       Ё Exclusiva da funcao CFGX035                                Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Static Function AbreArq(cAlias)

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Verifica se esta aberto                                      Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If Select(cAlias) > 0
		Return(.T.)
	EndIf

	DbSelectArea("SX2")
	Set Filter to
	DbSetOrder(1)
	DbSeek(cAlias)
	cArquivo := RetArq(__cRdd,Alltrim(x2_path)+alltrim(x2_Arquivo),.t.)
	If MSFile(cArquivo)
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Abertura dos arquivos em modo compartilhado                  Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If !ChkFile(cAlias,.F.)
			Return(.F.)
		Else
			Return(.T.)
		EndIf
	EndIf

	Return(.F.)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё FechaArq Ё Autor Ё Paulo Boschetti       Ё Data Ё 02/09/93 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Fecha arquivos utilizados                                  Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠ЁUso       Ё Exclusiva da funcao CFGX035                                Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Static Function FechaArq(cAlias)

	DbSelectArea(cAlias)
	DbCloseArea()
	Return(Nil)

	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё fSalAnt  Ё Autor Ё Juan Jose Pereira     Ё Data Ё 20.08.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o Saldo Anterior                                   Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso      Ё GENERICO                                                   Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Function fSalAnt()
	nRet := (CalcSaldo(nMes17Ini - 1)+TotDebitos(nMes17Ini,nMes17Fim)-TotCreditos(nMes17Ini,nMes17Fim))
	Return(nRet)
	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё  CodUM   Ё Autor Ё     Marcos Simidu     Ё Data Ё 13.10.97 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o Codigo da Unid. Medida                           Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso      Ё GENERICO                                                   Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Function CodUm(cChave)
	Local nCod:=0,cRet:=""
	nCod := Ascan(aUm,Alltrim(cChave))
	cRet := StrZero(nCod,3)
	Return(cRet)

Function NatEst(cChave)
	Local nCod:=0,cRet:=""
	nCod := Ascan(aNatEst,Alltrim(cChave))
	cRet := StrZero(nCod,3)
	Return(cRet)
	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o	 Ё  VerCod	Ё Autor Ё	  Marcos Simidu	    Ё Data Ё 13.10.97 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna os Codigos										  Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso		 Ё GENERICO 												  Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Function VerCod(cTab)
	Local aRet:={},nElem:=0

	DbSelectArea("SX5")
	If DbSeek(xFilial()+cTab,.F.)
		While !Eof() .And. Alltrim(X5_TABELA)==cTab
			nElem:=Ascan(aRet,  Alltrim(X5_CHAVE) )
			If nElem==0
				AADD(aRet, Alltrim(X5_CHAVE))
			Endif
			DbSkip()
		EndDo
	Endif

	Return(aRet)
	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o	 ЁC046LISTA Ё Autor Ё	  Marcos Simidu	    Ё Data Ё 26.11.97 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Listagem de Acompanhamento 								  Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso		 Ё GENERICO 												  Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Static Function C046Lista()

	Local cTela:=""

	aReturn :={"Zebrado", 1,"Administra┤└o", 2, 2, 1, "",1 }
	Nomeprog:="CFGX046"
	Titulo:="Relatorio de Acompanhamento"
	cDesc1:="Relatorio de Acompanhamento do arquivo pr┌-formatado."
	cDesc2:=""
	cDesc3:=""
	cPerg:="CFG046"
	Tamanho:="G"
	nTipo:=18
	cbCont:=0
	cbtxt:=Space(10)
	m_pag:=1
	cString :=Alias()
	wnrel:="CFG046"
	lEnd	:=.f.
	cAlias:=alias()
	nLastKey:=0
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Envia controle para a funcao SETPRINT 					     Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	wnrel:=SetPrint(cString,wnrel,cPerg,Titulo,cDesc1,cDesc2,cDesc3,.F.,"",.F.)
	If nLastKey==27
		Return
	Endif
	SetDefault(aReturn,cString)
	If nLastKey==27
		Return
	Endif

	RptStatus({|lEnd|C046RptDetail(@lEnd,wnRel,cString,Tamanho)},titulo)

	Return(Nil)
	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбдддддддддддддбддддддбдддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o	 ЁC046RptDetailЁAutor Ё Juan Jos┌ Pereira   Ё Data Ё 21/01/97 Ё╠╠
	╠╠цддддддддддедддддддддддддаддддддадддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o ЁChamada para impressao da listagem						  Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Function C046RptDetail(lEnd,wnRel,cString,Tamanho)

	Local i:=1,cLinha:="",cArquivo:=""
	Local nPaginas:=1,cFile:="",nTamReg:=0
	Local		cMeio   	:=Alltrim(mv_par05),;
		cCodif  	:=Alltrim(mv_par06),;
		cTamBloco:=Alltrim(mv_par07),;
		cEquip	:=Alltrim(mv_par08),;
		cSistOp	:=Alltrim(mv_par09),;
		cFabrica	:=Alltrim(mv_par10),;
		cSGBD		:=Alltrim(mv_par11),;
		cResp 	:=Alltrim(mv_par12),;
		cCPF		:=Alltrim(mv_par13),;
		cTelefone:=Alltrim(mv_par14)

	Local	nHandle,nBytes,aFile:={},nSize,nLinhas,nTamanho
	Local cTxt:=Space(1000),lGerouSX5:=.F.
	Local cTexto
	Private nTotLin:=0,cArqTxt:=""
	li:=80


	// Regua de Impressao
	SetRegua(Len(aLayOut))

	For i:=1 To Len(aLayout)

		IncRegua()		// Incrementa regua

		If (Padr(aLayOut[i],1)=="[" .Or. Padr(aLayOut[i],1)==Chr(26))
			cFile:=SubStr(aLayOut[i],50,3)
		Else
			Loop
		Endif

		cNroTab:=Substr(aLayOut[i],58,2)

		If Empty(Alltrim(cNroTab))
			cArqTxt:=Trim(cDiret)+SubStr(cFile,2,2)+cFilAnt+StrZero(Day(dDataBase),2) + StrZero(Month(dDataBase),2)+".TXT"
			cArquivo:=SubStr(cFile,2,2)+cFilAnt+StrZero(Day(dDataBase),2) + StrZero(Month(dDataBase),2)+".TXT"
		Else
			cArquivo := Alltrim(cNroTab)+cFilAnt+StrZero(Day(dDataBase),2) + StrZero(Month(dDataBase),2) + ".TXT"
			cArqTxt	:= Trim(cDiret)+Alltrim(cNroTab)+cFilAnt+StrZero(Day(dDataBase),2) + StrZero(Month(dDataBase),2) + ".TXT"
		Endif

		//	cArqTxt:=Trim(cDiret)+SubStr(cFile,2,2)+cFilAnt+StrZero(Day(dDataBase),2) + StrZero(Month(dDataBase),2)+".TXT"
		//	cArquivo:=SubStr(cFile,2,2)+cFilAnt+StrZero(Day(dDataBase),2) + StrZero(Month(dDataBase),2)+".TXT"

		//здддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Le arquivo texto - Nro total de linhas     Ё
		//юдддддддддддддддддддддддддддддддддддддддддддды
		nHandle:=fOpen(cArqTxt)						// Abre arquivo

		If nHandle<0	// erro na abertura do arquivo
			Loop
		Endif

		cTxt:=fReadStr(nHandle,1000)				// Linha de 1000 bytes

		nBytes:=(At(CHR(13)+CHR(10),cTxt))+1	// Procura final de linha

		nTamanho:=(At(CHR(13)+CHR(10),cTxt))-1	// Tamanho do registro

		aFile   := Directory( cArqTxt )        //-- Informa┤■es sobre o Arquivo

		nSize   := aFile[1,2]                   //-- Tamanho total do arquivo

		If !Empty(Alltrim(cNroTab))
			cTexto  := MemoRead(cArqTxt)
			nTotLin := MlCount(cTexto,nBytes)
		Else
			nTotLin := Int(nSize/nBytes)            //-- No de linhas do Arquivo
		Endif
		//здддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Nao imprime arquivos vazios                Ё
		//юдддддддддддддддддддддддддддддддддддддддддддды
		If nTotLin<=0.And.Empty(Alltrim(cNroTab))
			Loop
		Endif

		li:=80
		If li>55
			R046Cabec(@li)
		Endif

		li++
		@ ++li,00 PSAY "C.G.C.(MF)........: "+Transform(SM0->M0_CGC,"@R 99.999.999/9999-99")
		@ ++li,00 PSAY "Inscricao Estadual: "+SM0->M0_INSC
		@ ++li,00 PSAY "Local.............: "+SM0->M0_CIDCOB
		@ ++li,00 PSAY "Data..............: "+dtoc(ddatabase)
		@ ++li,00 PSAY "Razao Social......: "+SM0->M0_NOMECOM
		++li

		@ ++li,00 PSAY "Nome do Arquivo...: "+cArquivo
		@ ++li,00 PSAY "Meio-Armazenamento: "+cMeio
		@ ++li,00 PSAY "Codificacao.......: "+cCodif

		//здддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Verifica tamanho do registro               Ё
		//юдддддддддддддддддддддддддддддддддддддддддддды
		@ ++li,00 PSAY "Tamanho Registro..: "+Str(nTamanho)
		@ ++li,00 PSAY "Tamanho Bloco.....: "+cTamBloco
		++li

		@ ++li,00 PSAY "Sist.Operacional..: "+cSistOp
		@ ++li,00 PSAY "Equip.Utilizado...: "+cEquip
		@ ++li,00 PSAY "Fabrica...........: "+cFabrica
		@ ++li,00 PSAY "SGBD..............: "+cSGBD
		++li

		//здддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Le arquivo texto                           Ё
		//юдддддддддддддддддддддддддддддддддддддддддддды
		nPaginas:=Int(nTotLin/50)+1

		@ ++li,00 PSAY "DUMP 30 Primeiros.: "+Str(nPaginas)
		@ ++li,00 PSAY "DUMP 30 Ultimos...: "+Str(nPaginas)
		++li

		@ ++li,00 PSAY "LayOut registro...: 1"
		@ ++li,00 PSAY "Qtd. Volumes......: 1"

		@ ++li,00 PSAY "Qtd. Registros....: "+Str(nTotLin)
		++li

		@ ++li,00 PSAY "Funcionario Responsavel"
		@ ++li,00 PSAY "Nome..............: "+cResp
		@ ++li,00 PSAY "CPF...............: "+cCpf
		@ ++li,00 PSAY "Telefone:.........: "+cTelefone

		//здддддддддддддддддддддддддддддддддддддддддддд©
		//Ё LayOut do registro                		   Ё
		//юдддддддддддддддддддддддддддддддддддддддддддды
		li:=80
		i:=R046LayOut(i+1,@li,cArquivo)

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё DUMP do Arquivo - 30 primeiros registros do arquivo 		 Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		li:=80
		R046Dump(cArqTxt,"I",@li,nHandle,nBytes,nSize,cArquivo)

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё DUMP do Arquivo - 30 ultimos   registros do arquivo 		 Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		li:=80
		R046Dump(cArqTxt,"F",@li,nHandle,nBytes,nSize,cArquivo)

		fClose(nHandle)	// Fecha arquivo
	Next

	Roda(cbcont,cbtxt,tamanho)
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Spool de Impressao											 Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Set Printer to
	If aReturn[5] == 1
		dbcommitAll()
		ourspool(wnrel)
	Endif

	MS_FLUSH()

	Return
	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбдддддддддддбддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё R046LayOutЁAutor Ё   Marcos Simidu       Ё Data Ё 02.12.97 Ё╠╠
	╠╠цддддддддддедддддддддддаддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Impressao de LayOut                                        Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Function R046LayOut(i,li,cArquivo)

	While	i<=Len(aLayout) .And. Padr(aLayout[i],1)!="["

		If li>55
			R046Cabec(@li,"L",cArquivo)
			@++li,00 PSAY "Campo        Tipo    Tam.    Dec."
			//              x123456789x0123456789x132456789
			//              x         10         20
		Endif

		@++li,00 PSAY Padr(aLayout[i],11)
		@li,14 PSAY Subs(aLayout[i],12,1)
		@li,22 PSAY Subs(aLayout[i],14,2)
		@li,30 PSAY Subs(aLayout[i],17,1)

		i++
	EndDo

	Return(i-1)
	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбдддддддддддбддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё R046Dump  ЁAutor Ё   Marcos Simidu       Ё Data Ё 02.12.97 Ё╠╠
	╠╠цддддддддддедддддддддддаддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Impressao de Dump                                          Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Function R046Dump(cArqTxt,cDump,li,nHandle,nBytes,nSize,cArquivo)

	Local nVezes:=0
	Local cLine,ncw, i
	Local	nTotBack := 0
	Local aColObs:={}

	cDump:=(If(cDump==NIL," ",cDump))

	If cDump=="I"	// dump inicial

		fSeek(nHandle,0,0)

		nVezes:=If(nTotLin>30,30,nTotLin)

		cLine := Space(nBytes)

		For i:=1 To nVezes

			If li>55
				R046Cabec(@li,"I",cArquivo)
			Endif

			cLine:="Reg."+Alltrim(STR(i))+" - " + fReadStr( nHandle,nBytes )

			If !Empty(cLine)

				If Len(cLine)<=220
					@++li,00 PSAY cLine
					If li>=32
						R046Cabec(@li,"I",cArquivo)
					Endif
				Else
					For ncw:=1 to MlCount(cLine,220)

						@++li,00 PSAY MemoLine(cLine,220,ncw)
						++li
					Next
				Endif

			Endif
		Next

	Elseif cDump=="F"	// dump final

		fSeek(nHandle,0,2)

		cLine 	:= Space(nBytes)
		nVezes  := If(nTotLin < 30, nTotLin, 30)

		nTotBack := 0

		For i:=1 To nVezes

			If li>55
				R046Cabec(@li,"F",cArquivo)
			Endif

			nTotBack += nBytes

			fSeek(nHandle, -nTotBack, 2)
			cLine:="Reg."+AllTrim(STR(nTotLin - i))+" - " + fReadStr( nHandle,nBytes )
			fSeek(nHandle, -nTotBack, 2)

			If !Empty(cLine)

				If Len(cLine)<=220
					@++li,00 PSAY cLine
					If li>32
						R046Cabec(@li,"I",cArquivo)
					Endif
				Else
					For ncw:=1 to MlCount(cLine,220)
						@++li,00 PSAY MemoLine(cLine,220,ncw)
						++li
					Next
				Endif

			Endif

		Next
	Endif

	Return NIL
	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбдддддддддддбддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё R046Cabec ЁAutor Ё   Marcos Simidu       Ё Data Ё 02.12.97 Ё╠╠
	╠╠цддддддддддедддддддддддаддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Impressao de Cabecalho                                     Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Function R046Cabec(li,cDump,cArquivo)
	Local cMens:=""
	Local Titulo   := "Instrucao Normativa 068"
	Local Cabec1   := "Relatorio de acompanhamento"

	cDump:=(If(cDump==NIL," ",cDump))
	Do Case
	Case cDump=="I"	// dump inicial
		cMens:=" - DUMP dos 30 primeiros registros. Arquivo : " + cArquivo
	Case cDump=="F"	// dump inicial
		cMens:=" - DUMP dos 30 ultimos registros . Arquivo : " + cArquivo
	Case cDump=="L"	// layout
		cMens:=" - LayOut do arquivo . Arquivo : " + cArquivo
	EndCase

	//здддддддддддддддддддд©
	//Ё Imprime Cabecalho  Ё
	//юдддддддддддддддддддды
	cabec(Titulo,cabec1+cMens,"",nomeprog,Tamanho,ntipo)

	Return

	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    ЁGravaArrayЁ Autor Ё Edson Maricate        Ё Data Ё 15.01.99 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o ЁGrava uma determinado registro por um array                 Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso      Ё GENERICO                                                   Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Function GravaArray( aConteudo,nHdlArq,n)
	Local i,nTamanho,cConteudo
	Local cLinha:="",nDec:=0
	Local cInteiro:="",cDecimal:=""
	Local cSvAlias:=Alias()
	Local cTipo := "" , cVar := ""
	Local lTipo := .F., lVar := .F.

	For i:=1 To Len(aConteudo)

		If ! Empty(Subs(aConteudo[i],13,1))
			nTamanho := INT(VAL(SubStr(aConteudo[i],13,3)))
		Else
			nTamanho := INT(VAL(SubStr(aConteudo[i],14,2)))
		Endif
		cConteudo:= TRIM(SUBSTR(aConteudo[i],19,60))
		cTipo		:= Substr(aConteudo[i],12,1)
		nDec		:= Val(Substr(aConteudo[i],17,1))

		If Empty( cConteudo)
			xCampo := Replicate(" ",nTamanho)
		Else
			xCampo := &(cConteudo)
		Endif

		cVar:=ValType( (xCampo) )

		lTipo := (cTipo == "N")
		lVar	:= (cVar  == "N")

		If lVar .And. lTipo	// Formata campos numericos
			If nDec > 0
				xCampo := StrZero(xCampo*(10^nDec),nTamanho)
			Else
				xCampo := StrZero(xCampo,nTamanho)
			Endif
		ElseIf ( cVar$"C" .And. ( Len(xCampo) < nTamanho ) )	// Caracter
			xCampo += SPACE(nTamanho-Len(xCampo))
		ElseIf lVar .And. !lTipo
			xCampo:=Str(xCampo,nTamanho)
		ElseIf Empty(xCampo) .And. cTipo=="D"
			xCampo:=Repl("0",Len(xCampo))
		Else
			xCampo += SPACE(nTamanho-Len(xCampo))
		Endif

		If lTipo
			cLinha+=StrZero(Val(Left(xCampo,nTamanho)),nTamanho)
		Else
			cLinha+=SubStr(xCampo,1,nTamanho)
		Endif

	Next
	fWrite(nHdlArq, cLinha + Chr(13)+Chr(10), Len ( cLinha )+ 2 )
	nTamReg:=Len(cLinha)

	Return NIL


	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбдддддддддддбддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё Tabela2   ЁAutor Ё   Edson Maricate      Ё Data Ё 15.01.99 Ё╠╠
	╠╠цддддддддддедддддддддддаддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o Tipo de Operacao.                                Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Function Tabela2(cArq)
	Local cRet := "   "
	Local cAlias := Alias(), aArea

	If cArq == "SE1"
		DbSelectArea("SD2")
		aArea := GetArea()
		DbSetOrder(3)
		DbSeek(xFilial()+SE1->E1_NUM+SE1->E1_PREFIXO)
		cRet := SD2->D2_TES
	ElseIf cArq == "SE2"
		dbSelectArea("SD1")
		aArea := GetArea()
		DbSetOrder(1)
		dbSeek(xFilial()+SE2->E2_NUM+SE2->E2_PREFIXO)
		cRet := SD1->D1_TES
	ElseIf cArq == "SE5R"
		DbSelectArea("SD2")
		aArea := GetArea()
		DbSetOrder(3)
		DbSeek(xFilial()+SE5->E5_NUMERO+SE5->E5_PREFIXO)
		cRet := SD2->D2_TES
	ElseIf cArq == "SE5P"
		DbSelectArea("SD1")
		aArea := GetArea()
		DbSetOrder(1)
		DbSeek(xFilial()+SE5->E5_NUMERO+SE5->E5_PREFIXO)
		cRet := SD1->D1_TES
	EndIf

	If aArea # Nil
		RestArea(aArea)
	Endif

	DbSelectArea(cAlias)

	Return(Val(cRet))

	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбдддддддддддбддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё Tabela6   ЁAutor Ё   Edson Maricate      Ё Data Ё 15.01.99 Ё╠╠
	╠╠цддддддддддедддддддддддаддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o numero do tipo do titulo - Posicao 52 da Tab. 05 Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Function Tabela6(cTipo)
	Local cRet := "001"
	Local cAlias := Alias()
	dbSelectArea("SX5")
	If (dbSeek(xFilial("SX5") + "05" + cTipo ) )
		cRet := Right(X5_DESCRI, 3)
	Endif
	dbSelectArea(cAlias)
	Return(Val(cRet))

	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбдддддддддддбддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё Tabela7   ЁAutor Ё   Edson Maricate      Ё Data Ё 15.01.99 Ё╠╠
	╠╠цддддддддддедддддддддддаддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o status na do registro na tabela7-Categoria PJ/PF Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Function Tabela7(cArq)
	Local cRet := "  "

	If cArq == "SE1"
		cRet := "01"
	ElseIf cArq == "SE2"
		cRet := "02"
	ElseIf cArq == "SE5" .and. SE5->E5_RECPAG == "R"
		cRet := "01"
	ElseIf cArq == "SE5" .and. SE5->E5_RECPAG == "P"
		cRet := "02"
	EndIf

	Return cRet

	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбдддддддддддбддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё Tabela8   ЁAutor Ё Wagner Mobile Costa   Ё Data Ё 28.08.01 Ё╠╠
	╠╠цддддддддддедддддддддддаддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o codigo da tabela de especie de documento - Final Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Function Tabela8(cTipo)
	Local cRet := "01"
	Local cAlias := Alias()
	dbSelectArea("SX5")
	If (dbSeek(xFilial("SX5") + "42" + cTipo ) )
		cRet := Right(X5_DESCRI, 2)
	Endif
	dbSelectArea(cAlias)
	Return(cRet)

	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё Tabela11 Ё Autor Ё Wagner Mobile Costa   Ё Data Ё 28.08.01 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna a tabela da via de transporte                      Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
FUNCTION Tabela11(cVia)

	Local cAlias := Alias(), cRet := "001"

	DbSelectArea("SX5")
	DbSeek(cFilial + "NV")

	While X5_TABELA = "NV" .And. ! Eof()
		If cVia $ X5_DESCRI
			cRet := X5_CHAVE
			Exit
		Endif
		DbSkip()
	EndDo

	DbSelectArea(cAlias)

	Return cRet

	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё Tabela12 Ё Autor Ё Wagner Mobile Costa   Ё Data Ё 28.08.01 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna a tabela de especie de volumes                     Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
FUNCTION Tabela12(cEspecie)

	Local cAlias := Alias(), cRet := "001"

	DbSelectArea("SX5")
	DbSeek(cFilial + "NE")

	While X5_TABELA = "NE" .And. ! Eof()
		If cEspecie $ X5_DESCRI
			cRet := X5_CHAVE
			Exit
		Endif
		DbSkip()
	EndDo

	DbSelectArea(cAlias)

	Return cRet

	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбдддддддддддбддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё Tabela27  ЁAutor Ё   Edson Maricate      Ё Data Ё 28.08.01 Ё╠╠
	╠╠цддддддддддедддддддддддаддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna a situacao atual do bem - Tabela NA                Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Function Tabela27

	Local cRet := "001"

	If ! Empty(SN1->N1_BAIXA)
		cRet := "004"
	Endif

	If ! Empty(SN1->N1_DTBLOQ)
		cRet := "002"
	Endif

	If ! Empty(SN3->N3_FIMDEPR)	// Totalmente depreciado
		cRet := "003"
	Endif

	Return cRet

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё VerTipOp Ё Autor Ё Juan Jose Pereira     Ё Data Ё 20.08.96 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o Tipo de Operacao no item da nota fiscal          Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso      Ё GENERICO                                                   Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function VerTipOp(cMovimento,cTipoNf,cCFO,nValItem)

	Local cOperacao:=IIf(cMovimento=="S","001","004")

	Do Case
	Case cTipoNf=="D" ; cOperacao:="006"
	Case cTipoNf=="B" ; cOperacao:="021"
	Case cTipoNf=="C" ; cOperacao:="005"
	Case Substr(cCfo,2,2)=="91" ; cOperacao:="011"
	Case nValItem<0	; cOperacao:="013"
	EndCase

	Return(cOperacao)

	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё DataInt2 Ё Autor Ё Mauricio Pequim Jr    Ё Data Ё 02.05.00 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna a data conforme arquivo                            Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso      Ё GENERICO                                                   Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Function DataInt2(cRecpag,cEmiVen)
	Local cData:=" "
	Local dDataDes := CTOD("//")

	If cRecPag == "R" .and. cEmiVen == "E"  		// Emissao C.Receber
		dDataDes := SE1->E1_EMISSAO
	ElseIf cRecPag == "R" .and. cEmiVen == "V"	// Vencto  C.Receber
		dDataDes := SE1->E1_VENCTO
	ElseIf cRecPag == "P" .and. cEmiVen == "E"	// Emissao C.Pagar
		dDataDes := SE2->E2_EMIS1
	ElseIf cRecPag == "P" .and. cEmiVen == "V"	// Vencto  C.Pagar
		dDataDes := SE2->E2_VENCTO
	EndIf

	cData	:= DTOS(dDataDes) // AAAAMMDD
	cData := Right(cData,2)+SubStr(cData,5,2)+Left(cData,4) // DDMMAAAA

	Return(cData)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFuncao    Ё BxOnPrincЁ Autor Ё Wagner Xavier         Ё Data Ё 20.10.00 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescricao Ё Recupera apenas o valor da baixa principal                 Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso      Ё GENERICO                                                   Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/

Function BxOnPrinc()

	Local nValliq		:= 0
	Local cArea			:= Alias()
	Local aAreaSE5		:= {}
	Local aAreaSEn		:= {}
	Local dData			:= SE5_TRB->E5_DTDIGIT
	Local cChave		:= SE5_TRB->(E5_FILIAL+E5_PREFIXO+E5_NUMERO+E5_PARCELA+E5_TIPO+E5_CLIFOR+E5_LOJA+E5_SEQ)

	DbSelectArea("SE5")

	aAreaSE5 := GetArea()

	DbSetOrder(7)
	DbSeek(cChave)

	While ! Eof() .And. cChave==SE5->(E5_FILIAL+E5_PREFIXO+E5_NUMERO+E5_PARCELA+E5_TIPO+E5_CLIFOR+E5_LOJA+E5_SEQ)
		If SE5->E5_SITUACA <> "C"											// Verifica se a movimentacao nao foi cancelada
			If SE5->E5_DTDIGIT == dData									// Garantir a mesma baixa
				If SE5->E5_TIPODOC $ "VL/BA/LJ/V2/DC/D2/CP"
					nValLiq += SE5->E5_VALOR
				Elseif SE5->E5_TIPODOC $ "JR/MT/CM/CX/J2/M2/C2"
					nValliq -= SE5->E5_VALOR
				EndIf
			EndIf
		EndIf

		DbSkip()
	EndDo

	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Pesquisa no SE1 ou SE2 se ha AB- para o titulo                  Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды

	If SE5_TRB->E5_RECPAG == "P"
		DbSelectArea("SE2")
		cChave := "E2_FILIAL + E2_PREFIXO + E2_NUM + E2_PARCELA"
	Else
		DbSelectArea("SE1")
		cChave := "E1_FILIAL + E1_PREFIXO + E1_NUM + E1_PARCELA"
	EndIf

	aAreaSEn := GetArea()

	DbSetOrder(1)
	If DbSeek(xFilial()+SE5_TRB->E5_PREFIXO+SE5_TRB->E5_NUMERO+SE5_TRB->E5_PARCELA)
		While ! Eof() .And. &cChave == (SE5_TRB->E5_FILIAL+SE5_TRB->E5_PREFIXO+SE5_TRB->E5_NUMERO+SE5_TRB->E5_PARCELA)

			If SE5_TRB->E5_RECPAG == "P"
				If SE2->E2_TIPO $ MVABATIM .And. (SE2->E2_FORNECE+SE2->E2_LOJA) == (SE5_TRB->E5_CLIFOR+SE5_TRB->E5_LOJA)
					nValLiq += (SE2->E2_VLCRUZ - SE2->E2_SALDO)
				EndIf
			Else
				If SE1->E1_TIPO $ MVABATIM  .And. (SE1->E1_CLIENTE+SE1->E1_LOJA) == (SE5_TRB->E5_CLIFOR+SE5_TRB->E5_LOJA)
					nValLiq += (SE2->E2_VLCRUZ - SE2->E2_SALDO)
				EndIf
			EndIf

			DbSkip()
		EndDo
	EndIf

	RestArea(aAreaSEn)
	RestArea(aAreaSE5)
	DbSelectArea(cArea)

	Return(nValliq)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o	 Ё ContaCtb	Ё Autor Ё Wagner Xavier 		  Ё Data Ё 02.07.01 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o codigo da conta de um lancamento contabil		  Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso		 Ё GENERICO 												              Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function ContaCtb()
	Local cConta:=" "
	If CT2->CT2_DC $ "1"
		cConta := CT2->CT2_DEBITO
	ElseIf CT2->CT2_DC $ "2"
		cConta := CT2->CT2_CREDIT
	Else
		If lFirst
			cConta := CT2->CT2_DEBITO
		Else
			cConta := CT2->CT2_CREDIT
		EndIf
	EndIf
	Return(cConta)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o	 ЁTipoLanCtbЁ Autor Ё Wagner Xavier         Ё Data Ё 02.07.01 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o ЁRetorna o tipo do lancamento	 							        Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso		 ЁGENERICO 												                 Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function TipoLanCtb()
	Local cTipoLan:=" "
	If CT2->CT2_DC $ "1"
		cTipoLan := "D"
	ElseIf CT2->CT2_DC $ "2"
		ctipoLan := "C"
	Else
		If lFirst
			cTipoLan := "D"
		Else
			cTipoLan := "C"
		Endif
	Endif
	Return(cTipoLan)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o	 Ё ContraParЁ Autor Ё Wagner Xavier         Ё Data Ё 02.07.01 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna a contra partida de um lancamento contabil.		  Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso		 Ё GENERICO 					                     				  Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function CParCtb(lCentro)
	Local cConta:=" "

	DEFAULT lCentro := .F.

	If lCentro
		If CT2->CT2_DC $ "1"
			cConta := CT2->CT2_CCD
		ElseIf SI2->I2_DC $ "2"
			cConta := CT2->CT2_CCC
		Else
			If lFirst
				cConta := CT2->CT2_CCD
			Else
				cConta := CT2->CT2_CCC
			EndIf
		EndIf
	Else
		If CT2->CT2_DC $ "1"
			cConta := CT2->CT2_CREDIT
		ElseIf CT2->CT2_DC $ "2"
			cConta := CT2->CT2_DEBITO
		Else
			If lFirst
				cConta := CT2->CT2_CREDIT
			Else
				cConta := CT2->CT2_DEBITO
			Endif
		Endif
	Endif
	Return(cConta)

	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o	 ЁCustoCtb	Ё Autor Ё Wagner Xavier	        Ё Data Ё 02.07.01 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o centro de custo do lancamento.					  Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso		 Ё GENERICO             									  Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function CustoCtb()
	Local cCusto:=" "
	If CT2->CT2_DC $ "13"
		cCusto := CT2->CT2_CCD
	Else
		cCusto := CT2->CT2_CCC
	EndIf
	Return(cCusto)

	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддддддбддддддбддддддддддддддддддддддбддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё AjustaSX1    ЁAutor Ё  Alice Y Yamamoto    ЁDataЁ 25.04.01 Ё╠╠
	╠╠цддддддддддеддддддддддддддаддддддаддддддддддддддддддддддаддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Ajusta perguntas do SX1                                    Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/

STATIC FUNCTION AjustaSx1()
	Local aArea := { Alias(), IndexOrd() } , aPerg:={}
	Local cPerg := "CFG046"
	Local nI

	aPerg := {}
	Aadd(aPerg, {"17","Saldo Ctb Mes a Mes?","Saldo Ctb Mes a Mes?","Saldo Ctb Mes a Mes?",;
		"mv_chh","N",01,"C","mv_par11","Sim","Si","Yes","","Nao","No","No", 2 })
	nPerg := Len(aPerg)

	dbSelectArea("SX1")
	dbSetOrder(1)
	For nI := 1 To nPerg
		If ! dbSeek(cPerg+aPerg[nI,1])
			RecLock("SX1",.T.)
			Replace X1_GRUPO	With cPerg
			Replace X1_ORDEM	With aPerg[nI,01]
			Replace X1_PERGUNT	With aPerg[nI,02]
			Replace X1_PERSPA	With aPerg[nI,03]
			Replace X1_PERENG	With aPerg[nI,04]
			Replace X1_VARIAVL	With aPerg[nI,05]
			Replace X1_TIPO		With aPerg[nI,06]
			Replace X1_TAMANHO	With aPerg[nI,07]
			Replace X1_GSC		With aPerg[nI,08]
			Replace X1_VAR01	With aPerg[nI,09]
			Replace X1_DEF01	With aPerg[nI,10]
			Replace X1_DEFSPA1	With aPerg[nI,11]
			Replace X1_DEFENG1	With aPerg[nI,12]
			Replace X1_CNT01	With aPerg[nI,13]
			Replace X1_DEF02	With aPerg[nI,14]
			Replace X1_DEFSPA2	With aPerg[nI,15]
			Replace X1_DEFENG2	With aPerg[nI,16]
			Replace X1_PRESEL	With aPerg[nI,17]
			MsUnlock()
		EndIf
	Next

	dbSelectArea( aArea[1] )
	dbSetOrder( aArea[2] )
	Return
	/*/
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё TpFolha  Ё Autor Ё Andreia Santos        Ё Data Ё 17.06.02 Ё╠╠
	╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o Tipo de movimento na folha                       Ё╠╠
	╠╠Ё          Ё   1 = Mensalista                                           Ё╠╠
	╠╠Ё          Ё   2 = Semanalista                                          Ё╠╠
	╠╠Ё          Ё   3 = 13o. Salario                                         Ё╠╠
	╠╠Ё          Ё   4 = Ferias                                               Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠ЁSintaxe   Ё TpFolha(cCodPd)                                            Ё╠╠
	╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
	╠╠Ё Uso      Ё GENERICO                                                   Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	/*/
Function TpFolha(cCodPD)
	Local cTipfol	:=" "
	Local cData		:= SRD->RD_DATARQ
	Local nRecSRV	:= SRV->( recno())
	Local nRecSRD	:= SRD->( recno())
	Local nSRVOrd	:= SRV->( indexord())

	If SRV->RV_REFFER = "S"
		cTipFol := '3'
	Elseif SRV->RV_REF13 = "S" .Or. SUBS(SRD->RD_DATARQ,5,2) = '13'
		cTipFol := '2'
	Else
		cTipFol := '1'
	Endif

	SRV->(dbSetOrder(2))
	SRV->( dbSeek(xFilial("SRV")+"151"))
	If SRD->( dbseek( xFilial("SRD")+SRA->RA_MAT+cData+SRV->RV_COD))
		cTipFol := '4'
	EndIf

	SRV->(dbSetOrder(nSRVOrd))
	SRV->( dbGoto(nRecSRV) )
	SRD->( dbGoto(nRecSRD) )

	Return(cTipFol)


	/*
	эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	╠╠зддддддддддбдддддддддддбддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
	╠╠ЁFun┤┘o    Ё Historico ЁAutor Ё Wagner Mobile Costa   Ё Data Ё 03.07.02 Ё╠╠
	╠╠цддддддддддедддддддддддаддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
	╠╠ЁDescri┤┘o Ё Retorna o a string do historico (se tiver complemento soma)Ё╠╠
	╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
	╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
	ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ
	*/
Function Historico

	Local nRecno, cNumero
	Local cHistorico

	If CtbInUse()
		cHistorico 	:= AllTrim(CT2->CT2_HIST)
		nRecno		:= CT2->(Recno())
		cNumero		:= CT2->CT2_LOTE+CT2->CT2_DOC

		CT2->(DbSkip())
		While 	CT2->CT2_LOTE+CT2->CT2_DOC = cNumero .And. CT2->CT2_DC = '4' .And.;
				! CT2->(Eof())
			cHistorico += " " + AllTrim(CT2->CT2_HIST)
			CT2->(DbSkip())
		Enddo

		CT2->(DbGoto(nRecno))
	Else
		cHistorico 	:= AllTrim(SI2->I2_HIST)
		nRecno		:= SI2->(Recno())
		cNumero		:= SI2->I2_NUM

		SI2->(DbSkip())
		While SI2->I2_NUM = cNumero .And. SI2->I2_DC = '-' .And. ! SI2->(Eof())
			cHistorico += " " + AllTrim(SI2->I2_HIST)
			SI2->(DbSkip())
		Enddo

		SI2->(DbGoto(nRecno))
	Endif

	Return cHistorico
